import{r as g,i as j,j as e,F as C,d as c,V as I,C as a,e as r,f as l,a as t,T as w,J as U,K as G,N as x,O as h,m as n,b as d,G as E,a0 as F,H as P,a5 as q}from"./index-aBzEQGYq.js";import{P as y}from"./progress-XR5_hdtt.js";import{S as R}from"./search-BRbz_E2x.js";import{T as O}from"./trending-up-EJ-1Wo56.js";import{D as S}from"./database-DZHMcc4-.js";import{C as K}from"./clock-Dcf5yqqC.js";import{E as $}from"./eye-BznRa7X0.js";import{C as z}from"./circle-check-big-DoRqGQom.js";import{A as B}from"./activity-Bt7QQFFp.js";import{F as H}from"./file-text-DGolt20j.js";import{U as J}from"./users-DQHjr_4E.js";function ce(){const[D,M]=g.useState("all"),[p,V]=g.useState("30d"),[_,A]=g.useState(null),{data:i}=j({queryKey:["/api/compliance/overview"],refetchInterval:3e4}),{data:m}=j({queryKey:["/api/compliance/regulations"],refetchInterval:6e4}),{data:u}=j({queryKey:["/api/compliance/incidents",p],refetchInterval:3e4}),{data:f}=j({queryKey:["/api/compliance/audit-logs",p],refetchInterval:15e3}),T=s=>{switch(s){case"compliant":return"bg-green-500";case"partial":return"bg-yellow-500";case"non_compliant":return"bg-red-500";default:return"bg-gray-500"}},b=s=>{switch(s){case"low":return"bg-blue-100 text-blue-800";case"medium":return"bg-yellow-100 text-yellow-800";case"high":return"bg-orange-100 text-orange-800";case"critical":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},N=async s=>{try{await fetch(`/api/compliance/assess/${s}`,{method:"POST"})}catch(o){console.error("Assessment failed:",o)}},k=async()=>{try{const s=await fetch("/api/compliance/export",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({regulation:D,timeRange:p,format:"pdf"})});if(s.ok){const o=await s.blob(),L=URL.createObjectURL(o),v=document.createElement("a");v.href=L,v.download=`compliance-report-${Date.now()}.pdf`,v.click()}}catch(s){console.error("Export failed:",s)}};return e.jsxs("div",{className:"container mx-auto p-6 space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-foreground flex items-center",children:[e.jsx(C,{className:"w-8 h-8 mr-3 text-primary"}),"Compliance & Regulatory Dashboard"]}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Monitor compliance status, conduct assessments, and maintain regulatory adherence"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(c,{variant:"outline",onClick:k,children:[e.jsx(I,{className:"w-4 h-4 mr-2"}),"Export Report"]}),e.jsxs(c,{onClick:()=>N("all"),children:[e.jsx(R,{className:"w-4 h-4 mr-2"}),"Run Assessment"]})]})]}),i&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs(a,{children:[e.jsxs(r,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(l,{className:"text-sm font-medium",children:"Overall Compliance"}),e.jsx(O,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(t,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[i.overallScore.toFixed(1),"%"]}),e.jsx(y,{value:i.overallScore,className:"mt-3"}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:[i.compliantRegulations,"/",i.totalRegulations," regulations compliant"]})]})]}),e.jsxs(a,{children:[e.jsxs(r,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(l,{className:"text-sm font-medium",children:"Active Incidents"}),e.jsx(w,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(t,{children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:i.activeIncidents}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"Requiring immediate attention"})]})]}),e.jsxs(a,{children:[e.jsxs(r,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(l,{className:"text-sm font-medium",children:"Data Retention"}),e.jsx(S,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(t,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[i.dataRetentionCompliance.toFixed(1),"%"]}),e.jsx(y,{value:i.dataRetentionCompliance,className:"mt-3"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"Retention policy compliance"})]})]}),e.jsxs(a,{children:[e.jsxs(r,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(l,{className:"text-sm font-medium",children:"Pending Assessments"}),e.jsx(K,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(t,{children:[e.jsx("div",{className:"text-2xl font-bold",children:i.pendingAssessments}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"Due for review"})]})]})]}),e.jsxs(U,{defaultValue:"regulations",className:"space-y-4",children:[e.jsxs(G,{children:[e.jsx(x,{value:"regulations",children:"Regulations"}),e.jsx(x,{value:"incidents",children:"Incidents"}),e.jsx(x,{value:"audit-logs",children:"Audit Logs"}),e.jsx(x,{value:"assessments",children:"Assessments"}),e.jsx(x,{value:"reports",children:"Reports"})]}),e.jsx(h,{value:"regulations",className:"space-y-4",children:e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6",children:m==null?void 0:m.map(s=>e.jsxs(a,{className:"hover:shadow-md transition-shadow",children:[e.jsx(r,{children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx(l,{className:"text-lg",children:s.name}),e.jsx(n,{className:"mt-2",children:s.description})]}),e.jsx(d,{className:`${T(s.status)} text-white`,variant:"secondary",children:s.status.replace("_"," ").toUpperCase()})]})}),e.jsx(t,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[e.jsx("span",{children:"Compliance Score"}),e.jsxs("span",{className:"font-medium",children:[s.score.toFixed(1),"%"]})]}),e.jsx(y,{value:s.score})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-muted-foreground",children:"Gaps"}),e.jsx("div",{className:"font-medium text-red-600",children:s.gaps})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-muted-foreground",children:"Incidents"}),e.jsx("div",{className:"font-medium text-orange-600",children:s.incidents})]})]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Last assessed: ",new Date(s.lastAssessed).toLocaleDateString()]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(c,{size:"sm",variant:"outline",onClick:()=>A(s.id),children:[e.jsx($,{className:"w-4 h-4 mr-1"}),"Details"]}),e.jsxs(c,{size:"sm",onClick:()=>N(s.id),children:[e.jsx(R,{className:"w-4 h-4 mr-1"}),"Assess"]})]})]})})]},s.id))})}),e.jsx(h,{value:"incidents",className:"space-y-4",children:u&&u.length>0?e.jsx("div",{className:"space-y-4",children:u.map(s=>e.jsxs(E,{className:s.severity==="critical"?"border-red-500":s.severity==="high"?"border-orange-500":s.severity==="medium"?"border-yellow-500":"border-blue-500",children:[e.jsx(w,{className:"h-4 w-4"}),e.jsxs(F,{className:"flex items-center justify-between",children:[e.jsxs("span",{children:[s.regulation," - ",s.type]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(d,{className:b(s.severity),children:s.severity.toUpperCase()}),e.jsx(d,{variant:"outline",children:s.status.toUpperCase()})]})]}),e.jsx(P,{children:e.jsxs("div",{className:"mt-2",children:[e.jsx("p",{children:s.description}),e.jsxs("div",{className:"mt-3 text-sm text-muted-foreground",children:[e.jsxs("span",{children:["Affected: ",s.affectedUsers," users, ",s.affectedRecords," records"]}),e.jsxs("span",{className:"ml-4",children:["Reported: ",new Date(s.timestamp).toLocaleString()]})]})]})})]},s.id))}):e.jsx(a,{children:e.jsxs(t,{className:"text-center py-8",children:[e.jsx(z,{className:"w-12 h-12 text-green-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium",children:"No Active Incidents"}),e.jsx("p",{className:"text-muted-foreground",children:"All compliance incidents have been resolved"})]})})}),e.jsx(h,{value:"audit-logs",className:"space-y-4",children:e.jsxs(a,{children:[e.jsxs(r,{children:[e.jsxs(l,{className:"flex items-center",children:[e.jsx(B,{className:"w-5 h-5 mr-2"}),"Recent Audit Activity"]}),e.jsx(n,{children:"Comprehensive audit trail for compliance monitoring"})]}),e.jsx(t,{children:e.jsx("div",{className:"space-y-3",children:f==null?void 0:f.slice(0,10).map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted rounded-lg",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(d,{variant:"outline",className:"text-xs",children:s.level.toUpperCase()}),e.jsx(d,{variant:"outline",className:"text-xs",children:s.category}),s.regulations.map(o=>e.jsx(d,{variant:"secondary",className:"text-xs",children:o},o))]}),e.jsx("p",{className:"text-sm",children:s.message}),e.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:[new Date(s.timestamp).toLocaleString(),s.userId&&` • User: ${s.userId}`]})]}),e.jsx(d,{className:b(s.riskLevel),children:s.riskLevel.toUpperCase()})]},s.id))})})]})}),e.jsx(h,{value:"assessments",className:"space-y-4",children:e.jsxs(a,{children:[e.jsxs(r,{children:[e.jsx(l,{children:"Assessment Schedule"}),e.jsx(n,{children:"Manage and track compliance assessments across all regulations"})]}),e.jsx(t,{children:e.jsx("div",{className:"space-y-4",children:m==null?void 0:m.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:s.name}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Last: ",new Date(s.lastAssessed).toLocaleDateString()," • Next: ",new Date(s.nextAssessment).toLocaleDateString()]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-sm font-medium",children:[s.score.toFixed(1),"%"]}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Current Score"})]}),e.jsx(c,{size:"sm",onClick:()=>N(s.id),children:"Run Now"})]})]},s.id))})})]})}),e.jsx(h,{value:"reports",className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsxs(a,{className:"cursor-pointer hover:shadow-md transition-shadow",children:[e.jsxs(r,{children:[e.jsxs(l,{className:"flex items-center",children:[e.jsx(H,{className:"w-5 h-5 mr-2"}),"Compliance Summary"]}),e.jsx(n,{children:"Executive summary of overall compliance status"})]}),e.jsx(t,{children:e.jsx(c,{className:"w-full",children:"Generate Report"})})]}),e.jsxs(a,{className:"cursor-pointer hover:shadow-md transition-shadow",children:[e.jsxs(r,{children:[e.jsxs(l,{className:"flex items-center",children:[e.jsx(C,{className:"w-5 h-5 mr-2"}),"GDPR Report"]}),e.jsx(n,{children:"Detailed GDPR compliance assessment and evidence"})]}),e.jsx(t,{children:e.jsx(c,{className:"w-full",children:"Generate Report"})})]}),e.jsxs(a,{className:"cursor-pointer hover:shadow-md transition-shadow",children:[e.jsxs(r,{children:[e.jsxs(l,{className:"flex items-center",children:[e.jsx(q,{className:"w-5 h-5 mr-2"}),"Security Audit"]}),e.jsx(n,{children:"Security controls and audit trail analysis"})]}),e.jsx(t,{children:e.jsx(c,{className:"w-full",children:"Generate Report"})})]}),e.jsxs(a,{className:"cursor-pointer hover:shadow-md transition-shadow",children:[e.jsxs(r,{children:[e.jsxs(l,{className:"flex items-center",children:[e.jsx(J,{className:"w-5 h-5 mr-2"}),"Data Subject Rights"]}),e.jsx(n,{children:"Summary of data subject requests and responses"})]}),e.jsx(t,{children:e.jsx(c,{className:"w-full",children:"Generate Report"})})]}),e.jsxs(a,{className:"cursor-pointer hover:shadow-md transition-shadow",children:[e.jsxs(r,{children:[e.jsxs(l,{className:"flex items-center",children:[e.jsx(S,{className:"w-5 h-5 mr-2"}),"Data Retention"]}),e.jsx(n,{children:"Data retention policy compliance and cleanup status"})]}),e.jsx(t,{children:e.jsx(c,{className:"w-full",children:"Generate Report"})})]}),e.jsxs(a,{className:"cursor-pointer hover:shadow-md transition-shadow",children:[e.jsxs(r,{children:[e.jsxs(l,{className:"flex items-center",children:[e.jsx(w,{className:"w-5 h-5 mr-2"}),"Incident Summary"]}),e.jsx(n,{children:"Compliance incidents and remediation status"})]}),e.jsx(t,{children:e.jsx(c,{className:"w-full",children:"Generate Report"})})]})]})})]})]})}export{ce as default};
