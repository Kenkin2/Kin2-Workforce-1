import{r as g,u as S,o as T,i as E,l as v,j as e,F as b,C as m,e as u,f as x,a3 as F,m as h,a as p,z as c,_ as f,d,V as A,G as _,H as M,n as w,b as r,T as G}from"./index-aBzEQGYq.js";import{F as B}from"./file-text-DGolt20j.js";import{E as H}from"./eye-BznRa7X0.js";import{S as L}from"./square-pen-ajYTr43k.js";import{T as Q}from"./trash-2-Lk8FaCoE.js";import{C as k}from"./clock-Dcf5yqqC.js";import{C as Y}from"./circle-check-big-DoRqGQom.js";function I(){const[a,j]=g.useState({necessary:!0,analytics:!1,marketing:!1,functional:!1}),{toast:i}=S(),y=T(),{data:t,isLoading:C}=E({queryKey:["/api/gdpr/privacy-data"],retry:!1});g.useEffect(()=>{t!=null&&t.cookie_preferences&&j(t.cookie_preferences)},[t]);const D=v({mutationFn:async s=>w("POST","/api/gdpr/cookie-consent",{consents:s}),onSuccess:()=>{i({title:"Preferences Updated",description:"Your cookie preferences have been saved."}),y.invalidateQueries({queryKey:["/api/gdpr/privacy-data"]})},onError:s=>{i({title:"Update Failed",description:"Failed to update cookie preferences. Please try again.",variant:"destructive"})}}),n=v({mutationFn:async s=>w("POST","/api/gdpr/data-request",{requestType:s}),onSuccess:()=>{i({title:"Request Submitted",description:"Your data request has been submitted and will be processed within 30 days."}),y.invalidateQueries({queryKey:["/api/gdpr/privacy-data"]})},onError:s=>{i({title:"Request Failed",description:"Failed to submit data request. Please try again.",variant:"destructive"})}}),o=(s,R)=>{const N={...a,[s]:R};j(N),D.mutate(N)},l=s=>{n.mutate(s)},q=s=>{switch(s){case"completed":return e.jsxs(r,{variant:"default",className:"bg-green-500",children:[e.jsx(Y,{className:"w-3 h-3 mr-1"}),"Completed"]});case"pending":return e.jsxs(r,{variant:"secondary",children:[e.jsx(k,{className:"w-3 h-3 mr-1"}),"Pending"]});case"in_progress":return e.jsxs(r,{variant:"outline",children:[e.jsx(k,{className:"w-3 h-3 mr-1"}),"Processing"]});case"rejected":return e.jsxs(r,{variant:"destructive",children:[e.jsx(G,{className:"w-3 h-3 mr-1"}),"Rejected"]});default:return e.jsx(r,{variant:"outline",children:s})}},P=s=>{switch(s){case"access":return"Data Access Request";case"portability":return"Data Export Request";case"erasure":return"Data Deletion Request";case"rectification":return"Data Correction Request";default:return s}};return C?e.jsx("div",{className:"h-screen flex items-center justify-center",children:e.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-primary border-t-transparent rounded-full","aria-label":"Loading"})}):e.jsxs("div",{className:"container mx-auto p-6 max-w-4xl","data-testid":"privacy-dashboard",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("h1",{className:"text-3xl font-bold text-foreground flex items-center",children:[e.jsx(b,{className:"w-8 h-8 mr-3 text-primary"}),"Privacy & Data Protection"]}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Manage your data privacy preferences and exercise your GDPR rights"})]}),e.jsxs(m,{className:"mb-6","data-testid":"cookie-preferences-card",children:[e.jsxs(u,{children:[e.jsxs(x,{className:"flex items-center",children:[e.jsx(F,{className:"w-5 h-5 mr-2"}),"Cookie Preferences"]}),e.jsx(h,{children:"Control how we use cookies and tracking technologies on your device"})]}),e.jsxs(p,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("h4",{className:"font-medium",children:"Necessary Cookies"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Essential for the website to function properly"})]}),e.jsx(c,{checked:a.necessary,disabled:!0,"data-testid":"switch-necessary-cookies"})]}),e.jsx(f,{}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("h4",{className:"font-medium",children:"Analytics Cookies"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Help us understand how you use our website"})]}),e.jsx(c,{checked:a.analytics,onCheckedChange:s=>o("analytics",s),"data-testid":"switch-analytics-cookies"})]}),e.jsx(f,{}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("h4",{className:"font-medium",children:"Marketing Cookies"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Used to show you relevant advertisements"})]}),e.jsx(c,{checked:a.marketing,onCheckedChange:s=>o("marketing",s),"data-testid":"switch-marketing-cookies"})]}),e.jsx(f,{}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("h4",{className:"font-medium",children:"Functional Cookies"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Enable enhanced functionality and personalization"})]}),e.jsx(c,{checked:a.functional,onCheckedChange:s=>o("functional",s),"data-testid":"switch-functional-cookies"})]})]})]}),e.jsxs(m,{className:"mb-6","data-testid":"data-rights-card",children:[e.jsxs(u,{children:[e.jsxs(x,{className:"flex items-center",children:[e.jsx(B,{className:"w-5 h-5 mr-2"}),"Your Data Rights"]}),e.jsx(h,{children:"Exercise your rights under GDPR and other data protection laws"})]}),e.jsx(p,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs(d,{variant:"outline",className:"h-auto p-4 flex flex-col items-start text-left",onClick:()=>l("access"),disabled:n.isPending,"data-testid":"button-access-data",children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx(H,{className:"w-4 h-4 mr-2"}),e.jsx("span",{className:"font-medium",children:"Access My Data"})]}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Get a copy of all data we have about you"})]}),e.jsxs(d,{variant:"outline",className:"h-auto p-4 flex flex-col items-start text-left",onClick:()=>window.open("/api/gdpr/export-data","_blank"),"data-testid":"button-export-data",children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx(A,{className:"w-4 h-4 mr-2"}),e.jsx("span",{className:"font-medium",children:"Export My Data"})]}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Download your data in a portable format"})]}),e.jsxs(d,{variant:"outline",className:"h-auto p-4 flex flex-col items-start text-left",onClick:()=>l("rectification"),disabled:n.isPending,"data-testid":"button-correct-data",children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx(L,{className:"w-4 h-4 mr-2"}),e.jsx("span",{className:"font-medium",children:"Correct My Data"})]}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Request corrections to inaccurate data"})]}),e.jsxs(d,{variant:"outline",className:"h-auto p-4 flex flex-col items-start text-left border-red-200 hover:bg-red-50",onClick:()=>{confirm("Are you sure you want to delete all your data? This action cannot be undone.")&&l("erasure")},disabled:n.isPending,"data-testid":"button-delete-data",children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx(Q,{className:"w-4 h-4 mr-2 text-red-500"}),e.jsx("span",{className:"font-medium text-red-600",children:"Delete My Data"})]}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Permanently delete all your personal data"})]})]})})]}),(t==null?void 0:t.data_requests)&&t.data_requests.length>0&&e.jsxs(m,{"data-testid":"request-history-card",children:[e.jsxs(u,{children:[e.jsx(x,{children:"Request History"}),e.jsx(h,{children:"Track the status of your privacy requests"})]}),e.jsx(p,{children:e.jsx("div",{className:"space-y-4",children:t.data_requests.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium","data-testid":`request-type-${s.id}`,children:P(s.requestType)}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Submitted: ",new Date(s.createdAt).toLocaleDateString(),s.completedAt&&e.jsxs("span",{children:[" â€¢ Completed: ",new Date(s.completedAt).toLocaleDateString()]})]})]}),e.jsx("div",{"data-testid":`request-status-${s.id}`,children:q(s.status)})]},s.id))})})]}),e.jsxs(_,{className:"mt-6",children:[e.jsx(b,{className:"h-4 w-4"}),e.jsxs(M,{children:[e.jsx("strong",{children:"Your privacy matters to us."})," We process your data according to GDPR and other applicable data protection laws. Data requests are typically processed within 30 days. For questions about our privacy practices, please contact our Data Protection Officer."]})]})]})}export{I as default};
