import{g as P,o as S,r as b,i as u,l as y,j as e,b as i,Z as O,C as l,e as t,f as n,a as c,d as o,m as v,J as E,K as q,N as w,O as k,n as C}from"./index-aBzEQGYq.js";import{A as J,a as K,b as L}from"./avatar-B73pXDWb.js";import{C as T}from"./clock-Dcf5yqqC.js";import{C as F}from"./calendar-B5qd1N74.js";import{M as Q}from"./map-pin-D49hIz5W.js";import{T as R}from"./trending-up-EJ-1Wo56.js";function W(){var p,f,g;const{user:s}=P(),h=S(),[j,A]=b.useState(null),{data:r,isLoading:M}=u({queryKey:["/api/mobile/data"],enabled:!!s}),{data:x}=u({queryKey:["/api/mobile/nearby-jobs"],enabled:!!j&&(s==null?void 0:s.role)==="worker"});b.useEffect(()=>{navigator.geolocation&&navigator.geolocation.getCurrentPosition(a=>{A({lat:a.coords.latitude,lng:a.coords.longitude})},a=>console.error("Location error:",a))},[]);const d=y({mutationFn:async a=>C("POST","/api/mobile/clock",{action:a,location:j}),onSuccess:()=>{h.invalidateQueries({queryKey:["/api/mobile/data"]})}}),N=y({mutationFn:async a=>C("POST",`/api/jobs/${a}/accept`),onSuccess:()=>{h.invalidateQueries({queryKey:["/api/mobile/data"]})}});return M?e.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-50",children:e.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-primary border-t-transparent rounded-full"})}):e.jsxs("div",{className:"min-h-screen bg-gray-50 pb-20",children:[" ",e.jsx("div",{className:"bg-white shadow-sm border-b sticky top-0 z-10",children:e.jsx("div",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs(J,{className:"w-10 h-10",children:[e.jsx(K,{src:s==null?void 0:s.profileImageUrl}),e.jsxs(L,{children:[(p=s==null?void 0:s.firstName)==null?void 0:p[0],(f=s==null?void 0:s.lastName)==null?void 0:f[0]]})]}),e.jsxs("div",{children:[e.jsxs("h1",{className:"font-semibold text-gray-900",children:["Hi, ",s==null?void 0:s.firstName,"!"]}),e.jsx("p",{className:"text-sm text-gray-500",children:s==null?void 0:s.role})]})]}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs(i,{variant:"secondary",className:"bg-green-100 text-green-800",children:[e.jsx(O,{className:"w-3 h-3 mr-1"}),(s==null?void 0:s.karmaCoins)||0]})})]})})}),e.jsxs("div",{className:"p-4 space-y-4",children:[(s==null?void 0:s.role)==="worker"&&e.jsxs(e.Fragment,{children:[e.jsxs(l,{children:[e.jsx(t,{className:"pb-3",children:e.jsx(n,{className:"text-lg",children:"Quick Actions"})}),e.jsx(c,{children:e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs(o,{onClick:()=>d.mutate("in"),disabled:d.isPending,className:"h-16 flex-col space-y-1","data-testid":"button-clock-in",children:[e.jsx(T,{className:"w-5 h-5"}),e.jsx("span",{className:"text-sm",children:"Clock In"})]}),e.jsxs(o,{onClick:()=>d.mutate("out"),disabled:d.isPending,variant:"outline",className:"h-16 flex-col space-y-1","data-testid":"button-clock-out",children:[e.jsx(T,{className:"w-5 h-5"}),e.jsx("span",{className:"text-sm",children:"Clock Out"})]})]})})]}),e.jsxs(l,{children:[e.jsx(t,{className:"pb-3",children:e.jsxs(n,{className:"text-lg flex items-center",children:[e.jsx(F,{className:"w-5 h-5 mr-2"}),"Today's Schedule"]})}),e.jsx(c,{children:e.jsx("div",{className:"space-y-3",children:((g=r==null?void 0:r.schedule)==null?void 0:g.length)>0?r.schedule.map((a,m)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:a.jobTitle}),e.jsxs("p",{className:"text-sm text-gray-500",children:[a.startTime," - ",a.endTime]})]}),e.jsx(i,{children:a.status})]},m)):e.jsx("p",{className:"text-gray-500 text-center py-4",children:"No shifts scheduled for today"})})})]}),x&&x.length>0&&e.jsxs(l,{children:[e.jsxs(t,{className:"pb-3",children:[e.jsxs(n,{className:"text-lg flex items-center",children:[e.jsx(Q,{className:"w-5 h-5 mr-2"}),"Nearby Jobs"]}),e.jsx(v,{children:"Jobs within 10 miles of your location"})]}),e.jsx(c,{children:e.jsx("div",{className:"space-y-3",children:x.slice(0,3).map(a=>e.jsxs("div",{className:"p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("h3",{className:"font-medium",children:a.title}),e.jsxs(i,{children:[a.distance.toFixed(1)," mi"]})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:a.description}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"text-sm text-gray-500",children:["$",a.hourlyRate,"/hr â€¢ ",a.estimatedTravelTime," min"]}),e.jsx(o,{size:"sm",onClick:()=>N.mutate(a.id),disabled:N.isPending,"data-testid":`button-accept-job-${a.id}`,children:"Accept"})]})]},a.id))})})]})]}),e.jsxs(l,{children:[e.jsx(t,{className:"pb-3",children:e.jsxs(n,{className:"text-lg flex items-center",children:[e.jsx(R,{className:"w-5 h-5 mr-2"}),"This Week"]})}),e.jsx(c,{children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-primary",children:(s==null?void 0:s.role)==="worker"?"32":"147"}),e.jsx("div",{className:"text-sm text-gray-500",children:(s==null?void 0:s.role)==="worker"?"Hours Worked":"Jobs Posted"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-green-600",children:["$",(s==null?void 0:s.role)==="worker"?"1,280":"24,500"]}),e.jsx("div",{className:"text-sm text-gray-500",children:(s==null?void 0:s.role)==="worker"?"Earnings":"Revenue"})]})]})})]}),e.jsxs(l,{children:[e.jsx(t,{className:"pb-3",children:e.jsx(n,{className:"text-lg",children:"Recent Activity"})}),e.jsx(c,{children:e.jsx("div",{className:"space-y-3",children:[{action:"Completed shift at Downtown Office",time:"2 hours ago",icon:"âœ…"},{action:"New job assignment available",time:"4 hours ago",icon:"ðŸ’¼"},{action:"Earned 50 KarmaCoins bonus",time:"1 day ago",icon:"ðŸª™"}].map((a,m)=>e.jsxs("div",{className:"flex items-center space-x-3 p-2",children:[e.jsx("span",{className:"text-lg",children:a.icon}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium",children:a.action}),e.jsx("p",{className:"text-xs text-gray-500",children:a.time})]})]},m))})})]}),e.jsxs(E,{defaultValue:"offline",className:"w-full",children:[e.jsxs(q,{className:"grid w-full grid-cols-2",children:[e.jsx(w,{value:"offline",children:"Offline Mode"}),e.jsx(w,{value:"settings",children:"Mobile Settings"})]}),e.jsx(k,{value:"offline",className:"space-y-4",children:e.jsxs(l,{children:[e.jsxs(t,{children:[e.jsx(n,{className:"text-lg",children:"Offline Capabilities"}),e.jsx(v,{children:"Work without internet connection"})]}),e.jsx(c,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Offline Data Sync"}),e.jsx(i,{variant:"secondary",children:"Up to date"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Pending Actions"}),e.jsx(i,{children:"3 queued"})]}),e.jsx(o,{className:"w-full",variant:"outline","data-testid":"button-sync-offline",children:"Sync Now"})]})})]})}),e.jsx(k,{value:"settings",className:"space-y-4",children:e.jsxs(l,{children:[e.jsx(t,{children:e.jsx(n,{className:"text-lg",children:"Mobile Settings"})}),e.jsx(c,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Push Notifications"}),e.jsx(i,{variant:"secondary",children:"Enabled"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Location Tracking"}),e.jsx(i,{variant:"secondary",children:"Enabled"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Biometric Login"}),e.jsx(i,{children:"Available"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Offline Mode"}),e.jsx(i,{variant:"secondary",children:"Enabled"})]})]})})]})})]})]})]})}export{W as default};
