import{az as u,j as e,a9 as Ae,s as te,t as Ie,ap as ke,P as ae,p as Re,ad as Te,v as Se,r as R,k as B,u as _e,g as Pe,i as re,l as O,b as g,C as f,e as N,f as b,E as q,a as j,T as H,Z as I,J as Ee,K as De,N as J,O as W,$ as w,m as ie,n as z,q as X,d as A,_ as Me}from"./index-aBzEQGYq.js";import{c as ne,R as $e,T as Oe,b as ze,S as ee}from"./scroll-area-Dsz05QRK.js";import{C as qe}from"./index-oqkmxxPa.js";import{S as K}from"./sparkles-Cwuxkeql.js";import{C as V}from"./circle-check-big-DoRqGQom.js";import{T as se}from"./trending-up-EJ-1Wo56.js";import{C as He}from"./clock-Dcf5yqqC.js";var p="Accordion",Ke=["Home","End","ArrowDown","ArrowUp","ArrowLeft","ArrowRight"],[F,Ve,Le]=Ae(p),[T]=Ie(p,[Le,ne]),U=ne(),oe=u.forwardRef((s,o)=>{const{type:t,...n}=s,c=n,i=n;return e.jsx(F.Provider,{scope:s.__scopeAccordion,children:t==="multiple"?e.jsx(Qe,{...i,ref:o}):e.jsx(Ue,{...c,ref:o})})});oe.displayName=p;var[ce,Be]=T(p),[le,Fe]=T(p,{collapsible:!1}),Ue=u.forwardRef((s,o)=>{const{value:t,defaultValue:n,onValueChange:c=()=>{},collapsible:i=!1,...l}=s,[d,x]=te({prop:t,defaultProp:n,onChange:c});return e.jsx(ce,{scope:s.__scopeAccordion,value:d?[d]:[],onItemOpen:x,onItemClose:u.useCallback(()=>i&&x(""),[i,x]),children:e.jsx(le,{scope:s.__scopeAccordion,collapsible:i,children:e.jsx(de,{...l,ref:o})})})}),Qe=u.forwardRef((s,o)=>{const{value:t,defaultValue:n,onValueChange:c=()=>{},...i}=s,[l=[],d]=te({prop:t,defaultProp:n,onChange:c}),x=u.useCallback(m=>d((r=[])=>[...r,m]),[d]),a=u.useCallback(m=>d((r=[])=>r.filter(y=>y!==m)),[d]);return e.jsx(ce,{scope:s.__scopeAccordion,value:l,onItemOpen:x,onItemClose:a,children:e.jsx(le,{scope:s.__scopeAccordion,collapsible:!0,children:e.jsx(de,{...i,ref:o})})})}),[Ye,S]=T(p),de=u.forwardRef((s,o)=>{const{__scopeAccordion:t,disabled:n,dir:c,orientation:i="vertical",...l}=s,d=u.useRef(null),x=Re(d,o),a=Ve(t),r=Te(c)==="ltr",y=Se(s.onKeyDown,v=>{var G;if(!Ke.includes(v.key))return;const we=v.target,_=a().filter($=>{var Z;return!((Z=$.ref.current)!=null&&Z.disabled)}),C=_.findIndex($=>$.ref.current===we),Y=_.length;if(C===-1)return;v.preventDefault();let h=C;const P=0,E=Y-1,D=()=>{h=C+1,h>E&&(h=P)},M=()=>{h=C-1,h<P&&(h=E)};switch(v.key){case"Home":h=P;break;case"End":h=E;break;case"ArrowRight":i==="horizontal"&&(r?D():M());break;case"ArrowDown":i==="vertical"&&D();break;case"ArrowLeft":i==="horizontal"&&(r?M():D());break;case"ArrowUp":i==="vertical"&&M();break}const Ce=h%Y;(G=_[Ce].ref.current)==null||G.focus()});return e.jsx(Ye,{scope:t,disabled:n,direction:c,orientation:i,children:e.jsx(F.Slot,{scope:t,children:e.jsx(ae.div,{...l,"data-orientation":i,ref:x,onKeyDown:n?void 0:y})})})}),k="AccordionItem",[Ge,Q]=T(k),me=u.forwardRef((s,o)=>{const{__scopeAccordion:t,value:n,...c}=s,i=S(k,t),l=Be(k,t),d=U(t),x=ke(),a=n&&l.value.includes(n)||!1,m=i.disabled||s.disabled;return e.jsx(Ge,{scope:t,open:a,disabled:m,triggerId:x,children:e.jsx($e,{"data-orientation":i.orientation,"data-state":je(a),...d,...c,ref:o,disabled:m,open:a,onOpenChange:r=>{r?l.onItemOpen(n):l.onItemClose(n)}})})});me.displayName=k;var xe="AccordionHeader",ue=u.forwardRef((s,o)=>{const{__scopeAccordion:t,...n}=s,c=S(p,t),i=Q(xe,t);return e.jsx(ae.h3,{"data-orientation":c.orientation,"data-state":je(i.open),"data-disabled":i.disabled?"":void 0,...n,ref:o})});ue.displayName=xe;var L="AccordionTrigger",he=u.forwardRef((s,o)=>{const{__scopeAccordion:t,...n}=s,c=S(p,t),i=Q(L,t),l=Fe(L,t),d=U(t);return e.jsx(F.ItemSlot,{scope:t,children:e.jsx(Oe,{"aria-disabled":i.open&&!l.collapsible||void 0,"data-orientation":c.orientation,id:i.triggerId,...d,...n,ref:o})})});he.displayName=L;var pe="AccordionContent",fe=u.forwardRef((s,o)=>{const{__scopeAccordion:t,...n}=s,c=S(p,t),i=Q(pe,t),l=U(t);return e.jsx(ze,{role:"region","aria-labelledby":i.triggerId,"data-orientation":c.orientation,...l,...n,ref:o,style:{"--radix-accordion-content-height":"var(--radix-collapsible-content-height)","--radix-accordion-content-width":"var(--radix-collapsible-content-width)",...s.style}})});fe.displayName=pe;function je(s){return s?"open":"closed"}var Ze=oe,Je=me,We=ue,ge=he,ve=fe;const Xe=Ze,Ne=R.forwardRef(({className:s,...o},t)=>e.jsx(Je,{ref:t,className:B("border-b",s),...o}));Ne.displayName="AccordionItem";const be=R.forwardRef(({className:s,children:o,...t},n)=>e.jsx(We,{className:"flex",children:e.jsxs(ge,{ref:n,className:B("flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",s),...t,children:[o,e.jsx(qe,{className:"h-4 w-4 shrink-0 transition-transform duration-200"})]})}));be.displayName=ge.displayName;const ye=R.forwardRef(({className:s,children:o,...t},n)=>e.jsx(ve,{ref:n,className:"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...t,children:e.jsx("div",{className:B("pb-4 pt-0",s),children:o})}));ye.displayName=ve.displayName;function cs(){const{toast:s}=_e(),{user:o,isLoading:t}=Pe();R.useEffect(()=>{!t&&!o&&(window.location.href="/auth")},[o,t]);const{data:n=[],isLoading:c}=re({queryKey:["/api/issues/alerts"],enabled:!!o}),i=n.filter(r=>r.status==="active"),l=n.filter(r=>r.status==="resolved"),d=O({mutationFn:r=>z(`/api/issues/alerts/${r}/resolve`,"POST"),onSuccess:()=>{X.invalidateQueries({queryKey:["/api/issues/alerts"]}),s({title:"Issue Resolved",description:"The issue has been marked as resolved."})}}),x=O({mutationFn:r=>z(`/api/issues/alerts/${r}/dismiss`,"POST"),onSuccess:()=>{X.invalidateQueries({queryKey:["/api/issues/alerts"]}),s({title:"Issue Dismissed",description:"The issue has been dismissed."})}}),a=O({mutationFn:r=>z("/api/issues/actions","POST",{alertId:r.alertId,recommendationId:r.recommendationId,actionType:r.actionType,status:"completed"}),onSuccess:()=>{s({title:"Action Executed",description:"The recommended action has been executed successfully."})}}),m=r=>{switch(r){case"critical":return e.jsx(q,{className:"h-5 w-5 text-red-500"});case"high":return e.jsx(H,{className:"h-5 w-5 text-orange-500"});case"medium":return e.jsx(w,{className:"h-5 w-5 text-yellow-500"});default:return e.jsx(w,{className:"h-5 w-5 text-blue-500"})}};return t||c||!o?e.jsx("div",{className:"container mx-auto p-6",children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx(K,{className:"h-12 w-12 animate-spin mx-auto mb-4 text-primary"}),e.jsx("p",{className:"text-lg",children:"Analyzing your workforce..."})]})})}):e.jsxs("div",{className:"container mx-auto p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-bold mb-2","data-testid":"title-ai-resolution-center",children:"AI Resolution Center"}),e.jsx("p",{className:"text-lg text-muted-foreground",children:"Intelligent issue detection and automated recommendations"})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(g,{variant:"outline",className:"text-base px-4 py-2",children:[e.jsx(K,{className:"h-4 w-4 mr-2"}),"AI-Powered"]})})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-4",children:[e.jsxs(f,{"data-testid":"card-stat-critical",children:[e.jsxs(N,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(b,{className:"text-sm font-medium",children:"Critical Issues"}),e.jsx(q,{className:"h-5 w-5 text-red-500"})]}),e.jsxs(j,{children:[e.jsx("div",{className:"text-3xl font-bold","data-testid":"text-critical-count",children:i.filter(r=>r.severity==="critical").length}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Requires immediate attention"})]})]}),e.jsxs(f,{"data-testid":"card-stat-high",children:[e.jsxs(N,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(b,{className:"text-sm font-medium",children:"High Priority"}),e.jsx(H,{className:"h-5 w-5 text-orange-500"})]}),e.jsxs(j,{children:[e.jsx("div",{className:"text-3xl font-bold","data-testid":"text-high-count",children:i.filter(r=>r.severity==="high").length}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Action needed soon"})]})]}),e.jsxs(f,{"data-testid":"card-stat-resolved",children:[e.jsxs(N,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(b,{className:"text-sm font-medium",children:"Resolved Today"}),e.jsx(V,{className:"h-5 w-5 text-green-500"})]}),e.jsxs(j,{children:[e.jsx("div",{className:"text-3xl font-bold","data-testid":"text-resolved-count",children:l.length}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Successfully addressed"})]})]}),e.jsxs(f,{"data-testid":"card-stat-automatable",children:[e.jsxs(N,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(b,{className:"text-sm font-medium",children:"Auto-Solvable"}),e.jsx(I,{className:"h-5 w-5 text-yellow-500"})]}),e.jsxs(j,{children:[e.jsx("div",{className:"text-3xl font-bold","data-testid":"text-automatable-count",children:Math.floor(i.length*.7)}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Can be automated"})]})]})]}),e.jsxs(Ee,{defaultValue:"active",className:"space-y-4",children:[e.jsxs(De,{children:[e.jsxs(J,{value:"active","data-testid":"tab-active",children:["Active Issues (",i.length,")"]}),e.jsxs(J,{value:"resolved","data-testid":"tab-resolved",children:["Resolved (",l.length,")"]})]}),e.jsx(W,{value:"active",className:"space-y-4",children:i.length===0?e.jsx(f,{children:e.jsxs(j,{className:"flex flex-col items-center justify-center py-12",children:[e.jsx(V,{className:"h-16 w-16 text-green-500 mb-4"}),e.jsx("h3",{className:"text-2xl font-semibold mb-2",children:"All Clear!"}),e.jsx("p",{className:"text-muted-foreground text-center max-w-md",children:"No active issues detected. Your workforce operations are running smoothly."})]})}):e.jsx(ee,{className:"h-[600px] pr-4",children:e.jsx("div",{className:"space-y-4",children:i.map(r=>e.jsx(es,{alert:r,onResolve:()=>d.mutate(r.id),onDismiss:()=>x.mutate(r.id),onExecuteAction:(y,v)=>a.mutate({alertId:r.id,recommendationId:y,actionType:v})},r.id))})})}),e.jsx(W,{value:"resolved",className:"space-y-4",children:l.length===0?e.jsx(f,{children:e.jsxs(j,{className:"flex flex-col items-center justify-center py-12",children:[e.jsx(w,{className:"h-16 w-16 text-blue-500 mb-4"}),e.jsx("h3",{className:"text-2xl font-semibold mb-2",children:"No Resolved Issues Yet"}),e.jsx("p",{className:"text-muted-foreground",children:"Resolved issues will appear here for reference."})]})}):e.jsx(ee,{className:"h-[600px] pr-4",children:e.jsx("div",{className:"space-y-4",children:l.map(r=>e.jsx(f,{className:"opacity-75","data-testid":`card-alert-${r.id}`,children:e.jsx(N,{children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[m(r.severity),e.jsxs("div",{children:[e.jsx(b,{className:"text-lg",children:r.title}),e.jsx(ie,{className:"mt-1",children:r.description})]})]}),e.jsx(g,{className:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",children:"Resolved"})]})})},r.id))})})})]})]})}function es({alert:s,onResolve:o,onDismiss:t,onExecuteAction:n}){const{data:c=[]}=re({queryKey:["/api/issues/alerts",s.id,"recommendations"],queryFn:()=>fetch(`/api/issues/alerts/${s.id}/recommendations`).then(a=>a.json())}),i=a=>{switch(a){case"critical":return e.jsx(q,{className:"h-5 w-5 text-red-500"});case"high":return e.jsx(H,{className:"h-5 w-5 text-orange-500"});case"medium":return e.jsx(w,{className:"h-5 w-5 text-yellow-500"});default:return e.jsx(w,{className:"h-5 w-5 text-blue-500"})}},l=a=>{const m={critical:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200",high:"bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200",medium:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200",low:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200"};return e.jsx(g,{className:m[a]||"",children:a.toUpperCase()})},d=a=>{const m={high:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",medium:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200",low:"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200"};return e.jsxs(g,{variant:"outline",className:m[a]||"",children:[a," Impact"]})},x=[...c].sort((a,m)=>a.priority-m.priority);return e.jsxs(f,{className:"border-l-4",style:{borderLeftColor:s.severity==="critical"?"#ef4444":s.severity==="high"?"#f97316":s.severity==="medium"?"#eab308":"#3b82f6"},"data-testid":`card-alert-${s.id}`,children:[e.jsx(N,{children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[i(s.severity),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(b,{className:"text-xl",children:s.title}),l(s.severity),s.detectionMethod==="ai_powered"&&e.jsxs(g,{variant:"outline",className:"bg-purple-50 text-purple-700 dark:bg-purple-900/30 dark:text-purple-400",children:[e.jsx(K,{className:"h-3 w-3 mr-1"}),"AI"]})]}),e.jsx(ie,{className:"text-base",children:s.description}),e.jsxs("div",{className:"flex items-center gap-3 mt-3 text-sm text-muted-foreground",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(se,{className:"h-4 w-4"}),s.confidence,"% Confidence"]}),e.jsx("span",{children:"•"}),e.jsx("span",{className:"capitalize",children:s.affectedModule}),e.jsx("span",{children:"•"}),e.jsx("span",{className:"capitalize",children:s.issueType.replace(/_/g," ")})]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(A,{onClick:o,size:"sm",variant:"outline","data-testid":`button-resolve-${s.id}`,children:[e.jsx(V,{className:"h-4 w-4 mr-1"}),"Resolve"]}),e.jsx(A,{onClick:t,size:"sm",variant:"ghost","data-testid":`button-dismiss-${s.id}`,children:"Dismiss"})]})]})}),x.length>0&&e.jsxs(j,{className:"pt-0",children:[e.jsx(Me,{className:"mb-4"}),e.jsxs("h4",{className:"text-sm font-semibold mb-3 flex items-center gap-2",children:[e.jsx(I,{className:"h-4 w-4 text-yellow-500"}),"AI Recommendations (",x.length,")"]}),e.jsx(Xe,{type:"single",collapsible:!0,className:"space-y-2",children:x.map((a,m)=>e.jsxs(Ne,{value:a.id,className:"border rounded-lg px-4","data-testid":`recommendation-${a.id}`,children:[e.jsx(be,{className:"hover:no-underline",children:e.jsxs("div",{className:"flex items-center gap-3 flex-1 text-left",children:[e.jsxs(g,{variant:"outline",className:"text-xs",children:["#",a.priority]}),e.jsx("span",{className:"font-medium",children:a.title}),a.automatable&&e.jsxs(g,{className:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200 text-xs",children:[e.jsx(I,{className:"h-3 w-3 mr-1"}),"Auto"]}),d(a.estimatedImpact)]})}),e.jsx(ye,{className:"pb-4",children:e.jsxs("div",{className:"space-y-4 pt-2",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:a.description}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-muted-foreground",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(He,{className:"h-3 w-3"}),"~",a.estimatedDuration," min"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(se,{className:"h-3 w-3"}),a.confidence,"% Confidence"]}),e.jsx("span",{className:"capitalize",children:a.recommendationType.replace(/_/g," ")})]}),e.jsx("div",{className:"flex gap-2",children:a.automatable?e.jsxs(A,{size:"sm",onClick:()=>n(a.id,"automated"),className:"bg-green-600 hover:bg-green-700","data-testid":`button-execute-${a.id}`,children:[e.jsx(I,{className:"h-4 w-4 mr-1"}),"Execute Automatically"]}):e.jsx(A,{size:"sm",variant:"outline",onClick:()=>n(a.id,"manual"),"data-testid":`button-manual-${a.id}`,children:"Mark as Completed"})})]})})]},a.id))})]})]})}export{cs as default};
