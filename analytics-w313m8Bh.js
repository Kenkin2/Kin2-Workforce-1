import{r as v,i as S,j as e,C as r,a,d as L,V as P,J,K as U,N as l,O as b,e as c,f as d,m as o,T as W,b as E}from"./index-aBzEQGYq.js";import{A as z}from"./app-layout-DNSppN_P.js";import{S as K,a as M,b as O,c as V,d as m}from"./select-L0woBkk0.js";import{P as B}from"./progress-XR5_hdtt.js";import{T as x}from"./trending-up-EJ-1Wo56.js";import{U as N}from"./users-DQHjr_4E.js";import{T as F}from"./target-kE2L6cy0.js";import{A as w}from"./award-DPr5G0__.js";import{C as I}from"./calendar-B5qd1N74.js";import{R as y,a as G,X as $,Y as X,T as k,C as Y,L as _}from"./generateCategoricalChart-CE2-CpqZ.js";import{A as q,a as H}from"./AreaChart-BBd263fY.js";import{P as Q,a as Z}from"./PieChart-LCsI2DfQ.js";import"./avatar-B73pXDWb.js";import"./clock-Dcf5yqqC.js";import"./building-DW2XR0jT.js";import"./handshake-DxRR1pa7.js";import"./credit-card-CxGwdsfA.js";import"./calculator-Ch1wpyY6.js";import"./crown-J1RsCPzy.js";import"./map-pin-D49hIz5W.js";import"./pound-sterling-DvDjXgI4.js";import"./message-square-CV5BlX6z.js";import"./file-text-DGolt20j.js";import"./shield-check-DrJu6eCf.js";import"./Combination-D-0K7YMg.js";import"./index-oqkmxxPa.js";import"./scroll-area-Dsz05QRK.js";import"./alert-dialog-CGu9Do5w.js";import"./index-r-q9YERm.js";import"./dialog-23jdk0P0.js";import"./send-DOYPj-_D.js";function ee(){var u,f,g;const[h,C]=v.useState("7d"),[R,A]=v.useState("overview"),{data:s,isLoading:T}=S({queryKey:["/api/reports/analytics",h],refetchInterval:3e4}),i={monthlyRevenue:(s==null?void 0:s.monthlyRevenue)||0,activeJobs:(s==null?void 0:s.activeJobs)||0,totalWorkers:(s==null?void 0:s.totalWorkers)||0,completionRate:(s==null?void 0:s.completionRate)||0,chartData:(s==null?void 0:s.chartData)||{},predictions:{nextMonthRevenue:28500,workerDemand:15,riskFactors:[{factor:"Seasonal Demand Drop",risk:"medium",impact:"Revenue may decrease by 15%"},{factor:"Worker Shortage",risk:"high",impact:"May affect job completion rates"},{factor:"Client Retention",risk:"low",impact:"Strong client satisfaction scores"}]},kpis:{workerRetention:87,averageJobCompletion:94,clientSatisfaction:4.6,platformUtilization:78}},j=["#3b82f6","#10b981","#f59e0b","#ef4444","#8b5cf6","#ec4899","#06b6d4","#f97316"],p=t=>new Intl.NumberFormat("en-GB",{style:"currency",currency:"GBP"}).format(t),D=t=>{switch(t){case"high":return"destructive";case"medium":return"default";case"low":return"secondary";default:return"outline"}};return T?e.jsx("div",{className:"space-y-6",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:Array.from({length:4}).map((t,n)=>e.jsx(r,{className:"animate-pulse",children:e.jsx(a,{className:"p-6",children:e.jsx("div",{className:"h-20 bg-muted rounded"})})},n))})}):e.jsxs("div",{className:"space-y-6","data-testid":"enhanced-analytics-dashboard",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold tracking-tight",children:"Advanced Analytics"}),e.jsx("p",{className:"text-muted-foreground",children:"Real-time insights and predictive analytics for your workforce platform"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(K,{value:h,onValueChange:C,children:[e.jsx(M,{className:"w-32",children:e.jsx(O,{})}),e.jsxs(V,{children:[e.jsx(m,{value:"24h",children:"Last 24h"}),e.jsx(m,{value:"7d",children:"Last 7 days"}),e.jsx(m,{value:"30d",children:"Last 30 days"}),e.jsx(m,{value:"90d",children:"Last 3 months"})]})]}),e.jsxs(L,{variant:"outline",size:"sm","data-testid":"button-export-analytics",children:[e.jsx(P,{className:"h-4 w-4 mr-2"}),"Export"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(r,{children:e.jsx(a,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Worker Retention"}),e.jsxs("p",{className:"text-2xl font-bold",children:[i.kpis.workerRetention,"%"]}),e.jsxs("p",{className:"text-xs text-green-600 flex items-center",children:[e.jsx(x,{className:"h-3 w-3 mr-1"}),"+2.3% from last month"]})]}),e.jsx(N,{className:"h-8 w-8 text-muted-foreground"})]})})}),e.jsx(r,{children:e.jsx(a,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Job Completion"}),e.jsxs("p",{className:"text-2xl font-bold",children:[i.kpis.averageJobCompletion,"%"]}),e.jsxs("p",{className:"text-xs text-green-600 flex items-center",children:[e.jsx(x,{className:"h-3 w-3 mr-1"}),"+1.7% from last week"]})]}),e.jsx(F,{className:"h-8 w-8 text-muted-foreground"})]})})}),e.jsx(r,{children:e.jsx(a,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Client Satisfaction"}),e.jsxs("p",{className:"text-2xl font-bold",children:[i.kpis.clientSatisfaction,"/5"]}),e.jsxs("p",{className:"text-xs text-green-600 flex items-center",children:[e.jsx(w,{className:"h-3 w-3 mr-1"}),"Excellent rating"]})]}),e.jsx(w,{className:"h-8 w-8 text-muted-foreground"})]})})}),e.jsx(r,{children:e.jsx(a,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Platform Utilization"}),e.jsxs("p",{className:"text-2xl font-bold",children:[i.kpis.platformUtilization,"%"]}),e.jsx(B,{value:i.kpis.platformUtilization,className:"mt-2"})]}),e.jsx(I,{className:"h-8 w-8 text-muted-foreground"})]})})})]}),e.jsxs(J,{value:R,onValueChange:A,children:[e.jsxs(U,{children:[e.jsx(l,{value:"overview",children:"Overview"}),e.jsx(l,{value:"revenue",children:"Revenue"}),e.jsx(l,{value:"workforce",children:"Workforce"}),e.jsx(l,{value:"predictions",children:"Predictions"})]}),e.jsx(b,{value:"overview",className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsxs(r,{children:[e.jsxs(c,{children:[e.jsx(d,{children:"Revenue Trend"}),e.jsx(o,{children:"Monthly revenue performance"})]}),e.jsx(a,{children:e.jsx(y,{width:"100%",height:300,children:e.jsxs(q,{data:((u=s==null?void 0:s.chartData)==null?void 0:u.monthlyRevenue)||[],children:[e.jsx(G,{strokeDasharray:"3 3"}),e.jsx($,{dataKey:"month"}),e.jsx(X,{}),e.jsx(k,{formatter:t=>p(t)}),e.jsx(H,{type:"monotone",dataKey:"revenue",stroke:"#8884d8",fill:"#8884d8",fillOpacity:.3})]})})})]}),e.jsxs(r,{children:[e.jsxs(c,{children:[e.jsx(d,{children:"Job Categories"}),e.jsx(o,{children:"Distribution of job types"})]}),e.jsx(a,{children:e.jsx(y,{width:"100%",height:300,children:e.jsxs(Q,{children:[e.jsx(Z,{data:((f=s==null?void 0:s.chartData)==null?void 0:f.jobCategories)||[],cx:"50%",cy:"50%",labelLine:!0,label:({category:t,percent:n})=>`${t}: ${(n*100).toFixed(0)}%`,outerRadius:90,fill:"#8884d8",dataKey:"count",stroke:"#fff",strokeWidth:2,children:(((g=s==null?void 0:s.chartData)==null?void 0:g.jobCategories)||[]).map((t,n)=>e.jsx(Y,{fill:j[n%j.length]},`cell-${n}`))}),e.jsx(k,{contentStyle:{backgroundColor:"hsl(var(--background))",border:"1px solid hsl(var(--border))",borderRadius:"6px"}}),e.jsx(_,{})]})})})]})]})}),e.jsx(b,{value:"predictions",className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsxs(r,{children:[e.jsxs(c,{children:[e.jsx(d,{children:"Revenue Prediction"}),e.jsx(o,{children:"AI-powered revenue forecasting"})]}),e.jsx(a,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 bg-green-50 dark:bg-green-950/20 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Next Month Prediction"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:p(i.predictions.nextMonthRevenue)})]}),e.jsx(x,{className:"h-8 w-8 text-green-600"})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 bg-blue-50 dark:bg-blue-950/20 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Worker Demand"}),e.jsxs("p",{className:"text-2xl font-bold text-blue-600",children:["+",i.predictions.workerDemand," workers"]})]}),e.jsx(N,{className:"h-8 w-8 text-blue-600"})]})]})})]}),e.jsxs(r,{children:[e.jsxs(c,{children:[e.jsx(d,{children:"Risk Assessment"}),e.jsx(o,{children:"Potential risks and mitigation strategies"})]}),e.jsx(a,{children:e.jsx("div",{className:"space-y-3",children:i.predictions.riskFactors.map((t,n)=>e.jsx("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(W,{className:"h-4 w-4"}),e.jsx("span",{className:"font-medium",children:t.factor}),e.jsx(E,{variant:D(t.risk),children:t.risk})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:t.impact})]})},n))})})]})]})})]})]})}function Pe(){return e.jsx(z,{title:"Advanced Analytics",breadcrumbs:[{label:"Advanced Analytics"}],children:e.jsx(ee,{})})}export{Pe as default};
