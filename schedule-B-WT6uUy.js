import{c as Pe,r as y,u as B,o as re,i as P,l as W,j as e,d as g,C as S,a as k,b as O,U as He,I as E,e as H,f as L,n as D,p as ht,s as pt,t as jt,P as Le,v as ke,w as ft,x as gt,y as vt,k as De,h as Nt,T as Z,z as Ke,D as yt,M as bt,E as wt,F as Ct,G as Tt,H as St,S as kt,g as Dt,J as Rt,K as Et,N as V,O as Y}from"./index-aBzEQGYq.js";import{A as Mt}from"./app-layout-DNSppN_P.js";import{D as se,b as ae,c as ie,d as ne,a as ze}from"./dialog-23jdk0P0.js";import{S as me,a as ue,b as xe,c as he,d as G}from"./select-L0woBkk0.js";import{t as ye,c as Ue,m as be,s as Re,a as We,b as Ge,f as M}from"./format-CYGoIBvn.js";import{C as _e}from"./shield-check-DrJu6eCf.js";import{P as X}from"./plus-BIW1JAb4.js";import{C as le}from"./calendar-B5qd1N74.js";import{S as je}from"./square-pen-ajYTr43k.js";import{T as we}from"./trash-2-Lk8FaCoE.js";import{C as J}from"./clock-Dcf5yqqC.js";import{M as qt}from"./map-pin-D49hIz5W.js";import{T as At}from"./textarea-BY0bzfyA.js";import{F as Ne}from"./file-text-DGolt20j.js";import{P as te}from"./progress-XR5_hdtt.js";import{U as Ve}from"./users-DQHjr_4E.js";import{D as It}from"./dollar-sign-BYstf_kA.js";import{T as Ye}from"./target-kE2L6cy0.js";import{R as Ee,C as $t,T as Me,a as Ft,X as Ot,Y as Pt,L as Ht}from"./generateCategoricalChart-CE2-CpqZ.js";import{P as Lt,a as Kt}from"./PieChart-LCsI2DfQ.js";import{T as Be}from"./trending-up-EJ-1Wo56.js";import{L as zt,a as ge}from"./LineChart-BohXwQCU.js";import{A as Ut}from"./activity-Bt7QQFFp.js";import{C as qe}from"./calendar-days-4jemmO5l.js";import{M as Ae}from"./message-square-CV5BlX6z.js";import"./avatar-B73pXDWb.js";import"./building-DW2XR0jT.js";import"./handshake-DxRR1pa7.js";import"./credit-card-CxGwdsfA.js";import"./calculator-Ch1wpyY6.js";import"./crown-J1RsCPzy.js";import"./pound-sterling-DvDjXgI4.js";import"./Combination-D-0K7YMg.js";import"./index-oqkmxxPa.js";import"./scroll-area-Dsz05QRK.js";import"./alert-dialog-CGu9Do5w.js";import"./index-r-q9YERm.js";import"./send-DOYPj-_D.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qe=Pe("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wt=Pe("Repeat",[["path",{d:"m17 2 4 4-4 4",key:"nntrym"}],["path",{d:"M3 11v-1a4 4 0 0 1 4-4h14",key:"84bu3i"}],["path",{d:"m7 22-4-4 4-4",key:"1wqhfi"}],["path",{d:"M21 13v1a4 4 0 0 1-4 4H3",key:"1rx37r"}]]);function Q(t,a){const l=ye(t);return isNaN(a)?Ue(t,NaN):(a&&l.setDate(l.getDate()+a),l)}function Gt(t,a){const l=+ye(t);return Ue(t,l+a)}function Ie(t,a){return Gt(t,a*be)}function pe(t,a){const l=Re(t),d=Re(a);return+l==+d}function _t(t,a){const l=a==null?void 0:a.weekStartsOn,d=ye(t),s=d.getDay(),n=(s<l?-7:0)+6-(s-l);return d.setDate(d.getDate()+n),d.setHours(23,59,59,999),d}function F(t,a){const d=Qt(t);let s;if(d.date){const v=Zt(d.date,2);s=Xt(v.restDateString,v.year)}if(!s||isNaN(s.getTime()))return new Date(NaN);const n=s.getTime();let h=0,x;if(d.time&&(h=Jt(d.time),isNaN(h)))return new Date(NaN);if(d.timezone){if(x=es(d.timezone),isNaN(x))return new Date(NaN)}else{const v=new Date(n+h),b=new Date(0);return b.setFullYear(v.getUTCFullYear(),v.getUTCMonth(),v.getUTCDate()),b.setHours(v.getUTCHours(),v.getUTCMinutes(),v.getUTCSeconds(),v.getUTCMilliseconds()),b}return new Date(n+h+x)}const de={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},Vt=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,Yt=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,Bt=/^([+-])(\d{2})(?::?(\d{2}))?$/;function Qt(t){const a={},l=t.split(de.dateTimeDelimiter);let d;if(l.length>2)return a;if(/:/.test(l[0])?d=l[0]:(a.date=l[0],d=l[1],de.timeZoneDelimiter.test(a.date)&&(a.date=t.split(de.timeZoneDelimiter)[0],d=t.substr(a.date.length,t.length))),d){const s=de.timezone.exec(d);s?(a.time=d.replace(s[1],""),a.timezone=s[1]):a.time=d}return a}function Zt(t,a){const l=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+a)+"})|(\\d{2}|[+-]\\d{"+(2+a)+"})$)"),d=t.match(l);if(!d)return{year:NaN,restDateString:""};const s=d[1]?parseInt(d[1]):null,n=d[2]?parseInt(d[2]):null;return{year:n===null?s:n*100,restDateString:t.slice((d[1]||d[2]).length)}}function Xt(t,a){if(a===null)return new Date(NaN);const l=t.match(Vt);if(!l)return new Date(NaN);const d=!!l[4],s=ee(l[1]),n=ee(l[2])-1,h=ee(l[3]),x=ee(l[4]),v=ee(l[5])-1;if(d)return ns(a,x,v)?ts(a,x,v):new Date(NaN);{const b=new Date(0);return!as(a,n,h)||!is(a,s)?new Date(NaN):(b.setUTCFullYear(a,n,Math.max(s,h)),b)}}function ee(t){return t?parseInt(t):1}function Jt(t){const a=t.match(Yt);if(!a)return NaN;const l=ve(a[1]),d=ve(a[2]),s=ve(a[3]);return rs(l,d,s)?l*be+d*We+s*1e3:NaN}function ve(t){return t&&parseFloat(t.replace(",","."))||0}function es(t){if(t==="Z")return 0;const a=t.match(Bt);if(!a)return 0;const l=a[1]==="+"?-1:1,d=parseInt(a[2]),s=a[3]&&parseInt(a[3])||0;return ls(d,s)?l*(d*be+s*We):NaN}function ts(t,a,l){const d=new Date(0);d.setUTCFullYear(t,0,4);const s=d.getUTCDay()||7,n=(a-1)*7+l+1-s;return d.setUTCDate(d.getUTCDate()+n),d}const ss=[31,null,31,30,31,30,31,31,30,31,30,31];function Ze(t){return t%400===0||t%4===0&&t%100!==0}function as(t,a,l){return a>=0&&a<=11&&l>=1&&l<=(ss[a]||(Ze(t)?29:28))}function is(t,a){return a>=1&&a<=(Ze(t)?366:365)}function ns(t,a,l){return a>=1&&a<=53&&l>=0&&l<=6}function rs(t,a,l){return t===24?a===0&&l===0:l>=0&&l<60&&a>=0&&a<60&&t>=0&&t<25}function ls(t,a){return a>=0&&a<=59}function cs({view:t="week",selectedDate:a=new Date,onDateChange:l}){const[d,s]=y.useState(a),[n,h]=y.useState(null),[x,v]=y.useState({x:0,y:0}),[b,C]=y.useState(!1),[f,o]=y.useState(null),[u,c]=y.useState({title:"",jobId:"",startTime:"",endTime:"",hourlyRate:"",location:"",requirements:""}),{toast:m}=B(),r=re(),j=y.useRef(null);y.useEffect(()=>{const i=new WebSocket(`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}`);return i.onmessage=T=>{const p=JSON.parse(T.data);(p.type==="shift_updated"||p.type==="shift_created"||p.type==="shift_deleted")&&r.invalidateQueries({queryKey:["/api/shifts"]})},()=>i.close()},[r]);const w=Ge(d,{weekStartsOn:1}),K=_t(d,{weekStartsOn:1}),I=Array.from({length:7},(i,T)=>Q(w,T)),{data:N=[],isLoading:A}=P({queryKey:["/api/shifts",M(w,"yyyy-MM-dd"),M(K,"yyyy-MM-dd")],queryFn:async()=>(await D("GET",`/api/shifts?start=${M(w,"yyyy-MM-dd")}&end=${M(K,"yyyy-MM-dd")}`)).json()}),{data:R=[]}=P({queryKey:["/api/workers"],queryFn:async()=>(await D("GET","/api/workers")).json()}),{data:$=[]}=P({queryKey:["/api/jobs"],queryFn:async()=>(await D("GET","/api/jobs")).json()}),q=W({mutationFn:async i=>(!i.jobId&&$.length>0&&(i.jobId=$[0].id),(await D("POST","/api/shifts",i)).json()),onSuccess:()=>{m({title:"Shift created successfully"}),r.invalidateQueries({queryKey:["/api/shifts"]}),C(!1),c({title:"",jobId:"",startTime:"",endTime:"",hourlyRate:"",location:"",requirements:""})},onError:i=>{m({title:"Failed to create shift",description:i.message,variant:"destructive"})}}),z=W({mutationFn:async({id:i,...T})=>(await D("PATCH",`/api/shifts/${i}`,T)).json(),onSuccess:()=>{m({title:"Shift updated successfully"}),r.invalidateQueries({queryKey:["/api/shifts"]}),o(null)},onError:i=>{m({title:"Failed to update shift",description:i.message,variant:"destructive"})}}),Te=W({mutationFn:async i=>{await D("DELETE",`/api/shifts/${i}`)},onSuccess:()=>{m({title:"Shift deleted successfully"}),r.invalidateQueries({queryKey:["/api/shifts"]})},onError:i=>{m({title:"Failed to delete shift",description:i.message,variant:"destructive"})}}),ce=i=>{const T=Q(d,i==="next"?7:-7);s(T),l==null||l(T)},fe=()=>{const i=new Date;s(i),l==null||l(i)},it=(i,T)=>{h(T);const p=i.target.getBoundingClientRect();v({x:i.clientX-p.left,y:i.clientY-p.top}),i.dataTransfer.effectAllowed="move"},nt=i=>{i.preventDefault(),i.dataTransfer.dropEffect="move"},rt=y.useCallback((i,T,p)=>{if(i.preventDefault(),!n)return;const U=new Date(T);U.setHours(p,0,0,0);const mt=F(n.startTime),ut=(F(n.endTime).getTime()-mt.getTime())/(1e3*60*60),xt=Ie(U,ut);z.mutate({id:n.id,startTime:U.toISOString(),endTime:xt.toISOString()}),h(null)},[n,z]),lt=(i,T)=>{const p=new Date(i);p.setHours(T,0,0,0);const U=Ie(p,1);c({title:"",jobId:"",startTime:p.toISOString(),endTime:U.toISOString(),hourlyRate:"15",location:"",requirements:""}),C(!0)},ct=i=>N.filter(T=>pe(F(T.startTime),i)).sort((T,p)=>F(T.startTime).getTime()-F(p.startTime).getTime()),Se=Array.from({length:15},(i,T)=>7+T),dt=i=>{const T=F(i.startTime),U=(F(i.endTime).getTime()-T.getTime())/(1e3*60*60);return Math.max(1,U)*60},ot=i=>{const T=F(i.startTime);return(T.getHours()+T.getMinutes()/60-7)*60};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(g,{variant:"outline",onClick:()=>ce("prev"),"data-testid":"button-prev-week",children:e.jsx(Qe,{className:"w-4 h-4"})}),e.jsx(g,{variant:"outline",onClick:fe,"data-testid":"button-today",children:"Today"}),e.jsx(g,{variant:"outline",onClick:()=>ce("next"),"data-testid":"button-next-week",children:e.jsx(_e,{className:"w-4 h-4"})}),e.jsxs("h2",{className:"text-xl font-semibold",children:[M(w,"MMM d")," - ",M(K,"MMM d, yyyy")]})]}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs(g,{onClick:()=>C(!0),"data-testid":"button-create-shift",children:[e.jsx(X,{className:"w-4 h-4 mr-2"}),"Create Shift"]})})]}),e.jsx(S,{children:e.jsxs(k,{className:"p-0",children:[e.jsxs("div",{ref:j,className:"grid grid-cols-8 border-b",children:[e.jsx("div",{className:"p-4 border-r border-border bg-muted/30",children:e.jsx(le,{className:"w-5 h-5 text-muted-foreground"})}),I.map(i=>e.jsxs("div",{className:"p-4 border-r border-border text-center",children:[e.jsx("div",{className:"text-sm font-medium text-foreground",children:M(i,"EEE")}),e.jsx("div",{className:`text-lg font-semibold ${pe(i,new Date)?"text-primary":"text-muted-foreground"}`,children:M(i,"d")})]},i.toISOString()))]}),e.jsxs("div",{className:"grid grid-cols-8 relative",style:{minHeight:"900px"},children:[e.jsx("div",{className:"border-r border-border bg-muted/30",children:Se.map(i=>e.jsx("div",{className:"h-[60px] border-b border-border px-2 py-1 text-xs text-muted-foreground",children:M(new Date().setHours(i,0),"ha")},i))}),I.map((i,T)=>e.jsxs("div",{className:"border-r border-border relative",onDragOver:nt,children:[Se.map(p=>e.jsx("div",{className:"h-[60px] border-b border-border hover:bg-muted/50 cursor-pointer transition-colors",onDrop:U=>rt(U,i,p),onClick:()=>lt(i,p),"data-testid":`timeslot-${M(i,"yyyy-MM-dd")}-${p}`},p)),e.jsx("div",{className:"absolute inset-0 pointer-events-none",children:ct(i).map(p=>e.jsx("div",{className:"absolute left-1 right-1 pointer-events-auto cursor-move",style:{top:`${ot(p)}px`,height:`${dt(p)}px`,zIndex:10},draggable:!0,onDragStart:U=>it(U,p),"data-testid":`shift-${p.id}`,children:e.jsx(S,{className:"h-full shadow-lg hover:shadow-xl transition-shadow",children:e.jsxs(k,{className:"p-2 h-full flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx(O,{variant:p.status==="assigned"?"default":p.status==="completed"?"secondary":"outline",children:p.status}),e.jsxs("div",{className:"flex space-x-1",children:[e.jsx(g,{size:"sm",variant:"ghost",className:"h-6 w-6 p-0",onClick:()=>o(p),"data-testid":`button-edit-shift-${p.id}`,children:e.jsx(je,{className:"w-3 h-3"})}),e.jsx(g,{size:"sm",variant:"ghost",className:"h-6 w-6 p-0 text-destructive hover:text-destructive",onClick:()=>Te.mutate(p.id),"data-testid":`button-delete-shift-${p.id}`,children:e.jsx(we,{className:"w-3 h-3"})})]})]}),e.jsxs("div",{className:"flex-1 text-xs",children:[e.jsx("div",{className:"font-medium text-foreground mb-1 truncate",children:p.title}),e.jsxs("div",{className:"flex items-center text-muted-foreground mb-1",children:[e.jsx(J,{className:"w-3 h-3 mr-1"}),M(F(p.startTime),"h:mm a")," - ",M(F(p.endTime),"h:mm a")]}),p.worker&&e.jsxs("div",{className:"flex items-center text-muted-foreground mb-1",children:[e.jsx(He,{className:"w-3 h-3 mr-1"}),p.worker.firstName," ",p.worker.lastName]}),p.location&&e.jsxs("div",{className:"flex items-center text-muted-foreground",children:[e.jsx(qt,{className:"w-3 h-3 mr-1"}),e.jsx("span",{className:"truncate",children:p.location})]})]}),e.jsxs("div",{className:"text-xs font-medium text-primary",children:["$",p.hourlyRate,"/hr"]})]})})},p.id))})]},i.toISOString()))]})]})}),e.jsx(se,{open:b,onOpenChange:C,children:e.jsxs(ae,{children:[e.jsx(ie,{children:e.jsx(ne,{children:"Create New Shift"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(E,{placeholder:"Shift title",value:u.title,onChange:i=>c({...u,title:i.target.value}),"data-testid":"input-new-shift-title"}),e.jsxs(me,{onValueChange:i=>c({...u,jobId:i}),children:[e.jsx(ue,{"data-testid":"select-new-shift-job",children:e.jsx(xe,{placeholder:"Select job"})}),e.jsx(he,{children:$.map(i=>e.jsx(G,{value:i.id,children:i.title},i.id))})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(E,{type:"datetime-local",value:u.startTime.slice(0,16),onChange:i=>c({...u,startTime:i.target.value+":00.000Z"}),"data-testid":"input-new-shift-start"}),e.jsx(E,{type:"datetime-local",value:u.endTime.slice(0,16),onChange:i=>c({...u,endTime:i.target.value+":00.000Z"}),"data-testid":"input-new-shift-end"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(E,{type:"number",placeholder:"Hourly rate",value:u.hourlyRate,onChange:i=>c({...u,hourlyRate:i.target.value}),"data-testid":"input-new-shift-rate"}),e.jsx(E,{placeholder:"Location",value:u.location,onChange:i=>c({...u,location:i.target.value}),"data-testid":"input-new-shift-location"})]}),e.jsx(E,{placeholder:"Requirements or notes",value:u.requirements,onChange:i=>c({...u,requirements:i.target.value}),"data-testid":"input-new-shift-requirements"}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(g,{variant:"outline",onClick:()=>C(!1),children:"Cancel"}),e.jsx(g,{onClick:()=>q.mutate(u),disabled:q.isPending,"data-testid":"button-save-new-shift",children:q.isPending?"Creating...":"Create Shift"})]})]})]})}),e.jsx(se,{open:!!f,onOpenChange:()=>o(null),children:e.jsxs(ae,{children:[e.jsx(ie,{children:e.jsx(ne,{children:"Edit Shift"})}),f&&e.jsxs("div",{className:"space-y-4",children:[e.jsx(E,{placeholder:"Shift title",defaultValue:f.title,onChange:i=>o({...f,title:i.target.value}),"data-testid":"input-edit-shift-title"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(E,{type:"datetime-local",defaultValue:f.startTime.slice(0,16),onChange:i=>o({...f,startTime:i.target.value+":00.000Z"}),"data-testid":"input-edit-shift-start"}),e.jsx(E,{type:"datetime-local",defaultValue:f.endTime.slice(0,16),onChange:i=>o({...f,endTime:i.target.value+":00.000Z"}),"data-testid":"input-edit-shift-end"})]}),e.jsxs(me,{value:f.workerId||"",onValueChange:i=>o({...f,workerId:i}),children:[e.jsx(ue,{"data-testid":"select-edit-shift-worker",children:e.jsx(xe,{placeholder:"Assign worker"})}),e.jsxs(he,{children:[e.jsx(G,{value:"",children:"No worker assigned"}),R.map(i=>e.jsxs(G,{value:i.id,children:[i.firstName," ",i.lastName]},i.id))]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(E,{type:"number",placeholder:"Hourly rate",defaultValue:f.hourlyRate,onChange:i=>o({...f,hourlyRate:Number(i.target.value)}),"data-testid":"input-edit-shift-rate"}),e.jsx(E,{placeholder:"Location",defaultValue:f.location,onChange:i=>o({...f,location:i.target.value}),"data-testid":"input-edit-shift-location"})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(g,{variant:"outline",onClick:()=>o(null),children:"Cancel"}),e.jsx(g,{onClick:()=>z.mutate(f),disabled:z.isPending,"data-testid":"button-save-edit-shift",children:z.isPending?"Saving...":"Save Changes"})]})]})]})}),e.jsxs(S,{children:[e.jsx(H,{children:e.jsx(L,{children:"Calendar Legend"})}),e.jsx(k,{children:e.jsxs("div",{className:"flex items-center space-x-6 text-sm",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-4 h-4 bg-muted rounded mr-2"}),e.jsx("span",{children:"Available"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(O,{variant:"outline",className:"mr-2",children:"Draft"}),e.jsx("span",{children:"Unassigned"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(O,{variant:"default",className:"mr-2",children:"Assigned"}),e.jsx("span",{children:"Worker assigned"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(O,{variant:"secondary",className:"mr-2",children:"Completed"}),e.jsx("span",{children:"Shift completed"})]})]})})]}),A&&e.jsx("div",{className:"absolute inset-0 bg-background/50 flex items-center justify-center",children:e.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-primary border-t-transparent rounded-full"})})]})}const ds=["07:00","08:00","09:00","10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00","18:00","19:00","20:00","21:00","22:00"];function os({shifts:t,onCreateShift:a,onEditShift:l,onDeleteShift:d,isLoading:s}){const[n,h]=y.useState(new Date),[x,v]=y.useState(null),[b,C]=y.useState(null),[f,o]=y.useState(null),u=y.useRef(null),c=Ge(n,{weekStartsOn:1}),m=Array.from({length:7},(N,A)=>Q(c,A)),r=(N,A)=>t.filter(R=>{const $=F(R.startTime),q=M($,"HH:mm");return pe($,N)&&q===A}),j=(N,A)=>{const R=N.touches[0];u.current={x:R.clientX,y:R.clientY,time:Date.now()},C(A)},w=N=>{if(!b||!u.current)return;N.preventDefault();const A=N.touches[0],R=document.elementFromPoint(A.clientX,A.clientY),$=R==null?void 0:R.closest("[data-drop-target]");if($){const q=new Date($.getAttribute("data-date")||""),z=$.getAttribute("data-time")||"";o({date:q,time:z})}else o(null)},K=N=>{if(!b||!u.current)return;const A=N.changedTouches[0],R=Date.now()-u.current.time,$=Math.sqrt(Math.pow(A.clientX-u.current.x,2)+Math.pow(A.clientY-u.current.y,2));R<300&&$<10?v(b):f&&I(b,f),C(null),o(null),u.current=null},I=(N,A)=>{const R=new Date(A.date),[$,q]=A.time.split(":").map(Number);R.setHours($,q,0,0);const z=F(N.startTime),ce=F(N.endTime).getTime()-z.getTime(),fe=new Date(R.getTime()+ce);l({...N,startTime:R.toISOString(),endTime:fe.toISOString()})};return e.jsxs("div",{className:"mobile-calendar md:hidden",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4 sticky top-0 bg-background z-10 py-2",children:[e.jsx(g,{variant:"outline",size:"sm",onClick:()=>h(Q(n,-7)),"data-testid":"button-prev-week-mobile",children:e.jsx(Qe,{className:"w-4 h-4"})}),e.jsx("div",{className:"text-center",children:e.jsxs("div",{className:"font-semibold",children:[M(c,"MMM d")," - ",M(Q(c,6),"MMM d, yyyy")]})}),e.jsx(g,{variant:"outline",size:"sm",onClick:()=>h(Q(n,7)),"data-testid":"button-next-week-mobile",children:e.jsx(_e,{className:"w-4 h-4"})})]}),e.jsx("div",{className:"space-y-4",children:m.map((N,A)=>e.jsx(S,{children:e.jsxs(k,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold",children:M(N,"EEEE")}),e.jsx("p",{className:"text-sm text-muted-foreground",children:M(N,"MMM d")})]}),e.jsx(g,{size:"sm",variant:"outline",onClick:()=>a(N,"09:00"),"data-testid":`button-add-shift-${A}`,children:e.jsx(X,{className:"w-4 h-4"})})]}),e.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:ds.map(R=>{const $=r(N,R);return e.jsxs("div",{className:`min-h-12 p-2 rounded border-2 border-dashed transition-colors ${f&&pe(f.date,N)&&f.time===R?"border-primary bg-primary/10":"border-transparent hover:border-gray-300"}`,"data-drop-target":"true","data-date":N.toISOString(),"data-time":R,onClick:()=>$.length===0&&a(N,R),children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:R}),$.length===0?e.jsx("div",{className:"text-xs text-center text-muted-foreground py-2",children:"Tap to add shift"}):e.jsx("div",{className:"space-y-1",children:$.map(q=>e.jsxs("div",{className:`p-2 rounded border text-xs cursor-pointer select-none transition-transform ${(b==null?void 0:b.id)===q.id?"scale-95 opacity-50":"hover:scale-105"} ${q.status==="published"?"bg-blue-100 dark:bg-blue-900 border-blue-200 dark:border-blue-800":q.status==="assigned"?"bg-green-100 dark:bg-green-900 border-green-200 dark:border-green-800":"bg-gray-100 dark:bg-gray-800 border-gray-200 dark:border-gray-700"}`,onTouchStart:z=>j(z,q),onTouchMove:w,onTouchEnd:K,"data-testid":`shift-mobile-${q.id}`,children:[e.jsx("div",{className:"font-medium truncate",children:q.title}),e.jsxs("div",{className:"text-muted-foreground",children:[M(F(q.startTime),"HH:mm")," - ",M(F(q.endTime),"HH:mm")]}),q.workerId&&e.jsx(O,{variant:"secondary",className:"text-xs mt-1",children:"Assigned"})]},q.id))})]},R)})})]})},A))}),e.jsx(se,{open:!!x,onOpenChange:()=>v(null),children:e.jsxs(ae,{children:[e.jsx(ie,{children:e.jsxs(ne,{className:"flex items-center",children:[e.jsx(le,{className:"w-5 h-5 mr-2"}),x==null?void 0:x.title]})}),x&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Date:"})," ",M(F(x.startTime),"MMM d, yyyy")]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Time:"})," ",M(F(x.startTime),"HH:mm")," - ",M(F(x.endTime),"HH:mm")]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Status:"}),e.jsx(O,{className:"ml-2",variant:x.status==="published"?"default":x.status==="assigned"?"secondary":"outline",children:x.status})]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Rate:"})," $",x.hourlyRate,"/hr"]})]}),x.location&&e.jsxs("div",{children:[e.jsx("strong",{children:"Location:"})," ",x.location]}),x.requirements&&e.jsxs("div",{children:[e.jsx("strong",{children:"Requirements:"})," ",x.requirements]}),e.jsxs("div",{className:"flex space-x-2 pt-4",children:[e.jsxs(g,{className:"flex-1",onClick:()=>{l(x),v(null)},"data-testid":"button-edit-shift-mobile",children:[e.jsx(je,{className:"w-4 h-4 mr-2"}),"Edit Shift"]}),e.jsx(g,{variant:"destructive",onClick:()=>{d(x.id),v(null)},"data-testid":"button-delete-shift-mobile",children:"Delete"})]})]})]})}),s&&e.jsx("div",{className:"fixed inset-0 bg-background/80 backdrop-blur-sm z-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-primary border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"Loading schedule..."})]})}),b&&e.jsxs("div",{className:"fixed top-4 left-1/2 transform -translate-x-1/2 z-50 bg-primary text-primary-foreground px-3 py-1 rounded-full text-sm",children:["Moving: ",b.title]})]})}var Ce="Checkbox",[ms]=jt(Ce),[us,xs]=ms(Ce),Xe=y.forwardRef((t,a)=>{const{__scopeCheckbox:l,name:d,checked:s,defaultChecked:n,required:h,disabled:x,value:v="on",onCheckedChange:b,form:C,...f}=t,[o,u]=y.useState(null),c=ht(a,I=>u(I)),m=y.useRef(!1),r=o?C||!!o.closest("form"):!0,[j=!1,w]=pt({prop:s,defaultProp:n,onChange:b}),K=y.useRef(j);return y.useEffect(()=>{const I=o==null?void 0:o.form;if(I){const N=()=>w(K.current);return I.addEventListener("reset",N),()=>I.removeEventListener("reset",N)}},[o,w]),e.jsxs(us,{scope:l,state:j,disabled:x,children:[e.jsx(Le.button,{type:"button",role:"checkbox","aria-checked":_(j)?"mixed":j,"aria-required":h,"data-state":tt(j),"data-disabled":x?"":void 0,disabled:x,value:v,...f,ref:c,onKeyDown:ke(t.onKeyDown,I=>{I.key==="Enter"&&I.preventDefault()}),onClick:ke(t.onClick,I=>{w(N=>_(N)?!0:!N),r&&(m.current=I.isPropagationStopped(),m.current||I.stopPropagation())})}),r&&e.jsx(hs,{control:o,bubbles:!m.current,name:d,value:v,checked:j,required:h,disabled:x,form:C,style:{transform:"translateX(-100%)"},defaultChecked:_(n)?!1:n})]})});Xe.displayName=Ce;var Je="CheckboxIndicator",et=y.forwardRef((t,a)=>{const{__scopeCheckbox:l,forceMount:d,...s}=t,n=xs(Je,l);return e.jsx(ft,{present:d||_(n.state)||n.state===!0,children:e.jsx(Le.span,{"data-state":tt(n.state),"data-disabled":n.disabled?"":void 0,...s,ref:a,style:{pointerEvents:"none",...t.style}})})});et.displayName=Je;var hs=t=>{const{control:a,checked:l,bubbles:d=!0,defaultChecked:s,...n}=t,h=y.useRef(null),x=gt(l),v=vt(a);y.useEffect(()=>{const C=h.current,f=window.HTMLInputElement.prototype,u=Object.getOwnPropertyDescriptor(f,"checked").set;if(x!==l&&u){const c=new Event("click",{bubbles:d});C.indeterminate=_(l),u.call(C,_(l)?!1:l),C.dispatchEvent(c)}},[x,l,d]);const b=y.useRef(_(l)?!1:l);return e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:s??b.current,...n,tabIndex:-1,ref:h,style:{...t.style,...v,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function _(t){return t==="indeterminate"}function tt(t){return _(t)?"indeterminate":t?"checked":"unchecked"}var st=Xe,ps=et;const at=y.forwardRef(({className:t,...a},l)=>e.jsx(st,{ref:l,className:De("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",t),...a,children:e.jsx(ps,{className:De("flex items-center justify-center text-current"),children:e.jsx(Nt,{className:"h-4 w-4"})})}));at.displayName=st.displayName;const $e=[{value:1,label:"Monday"},{value:2,label:"Tuesday"},{value:3,label:"Wednesday"},{value:4,label:"Thursday"},{value:5,label:"Friday"},{value:6,label:"Saturday"},{value:0,label:"Sunday"}];function js(){const[t,a]=y.useState(!1),[l,d]=y.useState(null),[s,n]=y.useState({title:"",jobId:"",startTime:"09:00",endTime:"17:00",daysOfWeek:[],hourlyRate:"",location:"",requirements:""}),{toast:h}=B(),x=re(),{data:v=[],isLoading:b}=P({queryKey:["/api/recurring-shifts"],queryFn:async()=>(await D("GET","/api/recurring-shifts")).json()}),{data:C=[]}=P({queryKey:["/api/jobs"],queryFn:async()=>(await D("GET","/api/jobs")).json()}),f=W({mutationFn:async r=>(await D("POST","/api/recurring-shifts",r)).json(),onSuccess:()=>{h({title:"Recurring shift created successfully"}),x.invalidateQueries({queryKey:["/api/recurring-shifts"]}),a(!1),u()},onError:r=>{h({title:"Failed to create recurring shift",description:r.message,variant:"destructive"})}}),o=W({mutationFn:async({recurringId:r,weeks:j})=>(await D("POST",`/api/recurring-shifts/${r}/generate`,{weeks:j})).json(),onSuccess:r=>{h({title:`Generated ${r.count} shifts successfully`}),x.invalidateQueries({queryKey:["/api/shifts"]})},onError:r=>{h({title:"Failed to generate shifts",description:r.message,variant:"destructive"})}}),u=()=>{n({title:"",jobId:"",startTime:"09:00",endTime:"17:00",daysOfWeek:[],hourlyRate:"",location:"",requirements:""})},c=(r,j)=>{n(j?{...s,daysOfWeek:[...s.daysOfWeek,r].sort()}:{...s,daysOfWeek:s.daysOfWeek.filter(w=>w!==r)})},m=r=>r.map(j=>{var w;return(w=$e.find(K=>K.value===j))==null?void 0:w.label}).join(", ");return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Recurring Shifts"}),e.jsx("p",{className:"text-muted-foreground",children:"Create templates for repeating shift patterns"})]}),e.jsxs(se,{open:t,onOpenChange:a,children:[e.jsx(ze,{asChild:!0,children:e.jsxs(g,{"data-testid":"button-create-recurring-shift",children:[e.jsx(X,{className:"w-4 h-4 mr-2"}),"Create Recurring Shift"]})}),e.jsxs(ae,{className:"max-w-2xl",children:[e.jsx(ie,{children:e.jsx(ne,{children:"Create Recurring Shift Template"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(E,{placeholder:"Shift title",value:s.title,onChange:r=>n({...s,title:r.target.value}),"data-testid":"input-recurring-title"}),e.jsxs(me,{value:s.jobId,onValueChange:r=>n({...s,jobId:r}),children:[e.jsx(ue,{"data-testid":"select-recurring-job",children:e.jsx(xe,{placeholder:"Select job"})}),e.jsx(he,{children:C.map(r=>e.jsx(G,{value:r.id,children:r.title},r.id))})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsx(E,{type:"time",value:s.startTime,onChange:r=>n({...s,startTime:r.target.value}),"data-testid":"input-recurring-start-time"}),e.jsx(E,{type:"time",value:s.endTime,onChange:r=>n({...s,endTime:r.target.value}),"data-testid":"input-recurring-end-time"}),e.jsx(E,{type:"number",placeholder:"Hourly rate",value:s.hourlyRate,onChange:r=>n({...s,hourlyRate:r.target.value}),"data-testid":"input-recurring-rate"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-3 block",children:"Days of Week"}),e.jsx("div",{className:"grid grid-cols-4 gap-3",children:$e.map(r=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(at,{id:`day-${r.value}`,checked:s.daysOfWeek.includes(r.value),onCheckedChange:j=>c(r.value,j),"data-testid":`checkbox-day-${r.value}`}),e.jsx("label",{htmlFor:`day-${r.value}`,className:"text-sm",children:r.label})]},r.value))})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(E,{placeholder:"Location",value:s.location,onChange:r=>n({...s,location:r.target.value}),"data-testid":"input-recurring-location"}),e.jsx(E,{placeholder:"Requirements",value:s.requirements,onChange:r=>n({...s,requirements:r.target.value}),"data-testid":"input-recurring-requirements"})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(g,{variant:"outline",onClick:()=>a(!1),children:"Cancel"}),e.jsx(g,{onClick:()=>f.mutate(s),disabled:f.isPending||!s.title||!s.jobId||s.daysOfWeek.length===0,"data-testid":"button-save-recurring",children:f.isPending?"Creating...":"Create Template"})]})]})]})]})]}),e.jsx("div",{className:"grid gap-4",children:b?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"animate-spin w-6 h-6 border-4 border-primary border-t-transparent rounded-full"})}):v.length===0?e.jsx(S,{children:e.jsxs(k,{className:"py-8 text-center",children:[e.jsx(Wt,{className:"w-12 h-12 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No Recurring Shifts"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Create templates for shifts that repeat regularly"}),e.jsxs(g,{onClick:()=>a(!0),children:[e.jsx(X,{className:"w-4 h-4 mr-2"}),"Create First Template"]})]})}):v.map(r=>e.jsx(S,{children:e.jsx(k,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[e.jsx("h4",{className:"font-semibold text-lg",children:r.title}),e.jsx(O,{variant:r.isActive?"default":"secondary",children:r.isActive?"Active":"Inactive"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(J,{className:"w-4 h-4 mr-2"}),r.startTime," - ",r.endTime]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(le,{className:"w-4 h-4 mr-2"}),m(r.daysOfWeek)]})]}),r.location&&e.jsxs("p",{className:"text-sm text-muted-foreground mt-2",children:["ðŸ“ ",r.location]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"text-right mr-4",children:e.jsxs("div",{className:"font-semibold text-primary",children:["$",r.hourlyRate,"/hr"]})}),e.jsxs(me,{onValueChange:j=>o.mutate({recurringId:r.id,weeks:parseInt(j)}),children:[e.jsx(ue,{className:"w-32","data-testid":`select-generate-${r.id}`,children:e.jsx(xe,{placeholder:"Generate"})}),e.jsxs(he,{children:[e.jsx(G,{value:"1",children:"1 week"}),e.jsx(G,{value:"2",children:"2 weeks"}),e.jsx(G,{value:"4",children:"4 weeks"}),e.jsx(G,{value:"8",children:"8 weeks"})]})]}),e.jsx(g,{size:"sm",variant:"outline","data-testid":`button-edit-recurring-${r.id}`,children:e.jsx(je,{className:"w-4 h-4"})}),e.jsx(g,{size:"sm",variant:"outline","data-testid":`button-delete-recurring-${r.id}`,children:e.jsx(we,{className:"w-4 h-4"})})]})]})})},r.id))})]})}const Fe=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];function fs(){const[t,a]=y.useState(""),[l,d]=y.useState({}),{toast:s}=B(),n=re(),{data:h=[]}=P({queryKey:["/api/users","worker"],queryFn:async()=>(await D("GET","/api/users?role=worker")).json()}),{data:x=[],isLoading:v}=P({queryKey:["/api/worker-availability",t],enabled:!!t,queryFn:async()=>(await D("GET",`/api/worker-availability/${t}`)).json()}),b=W({mutationFn:async m=>(await D("PUT",`/api/worker-availability/${t}`,m)).json(),onSuccess:()=>{s({title:"Availability updated successfully"}),n.invalidateQueries({queryKey:["/api/worker-availability",t]}),d({})},onError:m=>{s({title:"Failed to update availability",description:m.message,variant:"destructive"})}}),{data:C=[]}=P({queryKey:["/api/scheduling-conflicts",t],enabled:!!t,queryFn:async()=>(await D("GET",`/api/scheduling-conflicts/${t}`)).json()}),f=m=>x.find(r=>r.dayOfWeek===m)||{dayOfWeek:m,startTime:"09:00",endTime:"17:00",isAvailable:!1},o=(m,r,j)=>{const w=`${m}-${r}`;d({...l,[w]:j})},u=(m,r,j)=>{const w=`${m}-${r}`;return l[w]!==void 0?l[w]:j},c=()=>{const m=Fe.map((r,j)=>{const w=f(j);return{dayOfWeek:j,startTime:u(j,"startTime",w.startTime),endTime:u(j,"endTime",w.endTime),isAvailable:u(j,"isAvailable",w.isAvailable)}});b.mutate({availability:m})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Worker Availability"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Manage when workers are available for shifts"}),e.jsxs("div",{className:"flex items-center space-x-4 mb-6",children:[e.jsxs("select",{className:"px-3 py-2 border rounded-md",value:t,onChange:m=>a(m.target.value),"data-testid":"select-worker-availability",children:[e.jsx("option",{value:"",children:"Select worker..."}),h.map(m=>e.jsxs("option",{value:m.id,children:[m.firstName," ",m.lastName," (",m.email,")"]},m.id))]}),C.length>0&&e.jsxs(O,{variant:"destructive",className:"flex items-center",children:[e.jsx(Z,{className:"w-3 h-3 mr-1"}),C.length," conflicts"]})]})]}),t&&e.jsxs(S,{children:[e.jsx(H,{children:e.jsxs(L,{className:"flex items-center",children:[e.jsx(He,{className:"w-5 h-5 mr-2"}),"Weekly Availability"]})}),e.jsx(k,{children:v?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"animate-spin w-6 h-6 border-4 border-primary border-t-transparent rounded-full"})}):e.jsxs("div",{className:"space-y-4",children:[Fe.map((m,r)=>{const j=f(r),w=u(r,"isAvailable",j.isAvailable),K=u(r,"startTime",j.startTime),I=u(r,"endTime",j.endTime);return e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-20 font-medium",children:m}),e.jsx(Ke,{checked:w,onCheckedChange:N=>o(r,"isAvailable",N),"data-testid":`switch-available-${r}`}),e.jsx("span",{className:"text-sm text-muted-foreground",children:w?"Available":"Not available"})]}),w&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(E,{type:"time",value:K,onChange:N=>o(r,"startTime",N.target.value),className:"w-24","data-testid":`input-start-time-${r}`}),e.jsx("span",{className:"text-muted-foreground",children:"to"}),e.jsx(E,{type:"time",value:I,onChange:N=>o(r,"endTime",N.target.value),className:"w-24","data-testid":`input-end-time-${r}`})]})]},m)}),Object.keys(l).length>0&&e.jsxs("div",{className:"flex justify-end space-x-2 pt-4 border-t",children:[e.jsx(g,{variant:"outline",onClick:()=>d({}),children:"Cancel Changes"}),e.jsx(g,{onClick:c,disabled:b.isPending,"data-testid":"button-save-availability",children:b.isPending?"Saving...":"Save Changes"})]})]})})]}),C.length>0&&e.jsxs(S,{children:[e.jsx(H,{children:e.jsxs(L,{className:"flex items-center text-destructive",children:[e.jsx(Z,{className:"w-5 h-5 mr-2"}),"Scheduling Conflicts"]})}),e.jsx(k,{children:e.jsx("div",{className:"space-y-3",children:C.map((m,r)=>{var j,w;return e.jsxs("div",{className:"p-3 border-l-4 border-destructive bg-destructive/5 rounded",children:[e.jsx("div",{className:"font-medium",children:m.shiftTitle}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[new Date(m.startTime).toLocaleDateString()," ",(j=m.startTime.split("T")[1])==null?void 0:j.slice(0,5)," - ",(w=m.endTime.split("T")[1])==null?void 0:w.slice(0,5)]}),e.jsx("div",{className:"text-sm text-destructive mt-1",children:m.reason})]},r)})})})]})]})}function gs(){const[t,a]=y.useState(!1),[l,d]=y.useState(null),[s,n]=y.useState({name:"",duration:"",hourlyRate:"",requirements:"",description:""}),{toast:h}=B(),x=re(),{data:v=[],isLoading:b}=P({queryKey:["/api/shift-templates"],queryFn:async()=>(await D("GET","/api/shift-templates")).json()}),C=W({mutationFn:async c=>(await D("POST","/api/shift-templates",{...c,duration:parseInt(c.duration),hourlyRate:parseFloat(c.hourlyRate)})).json(),onSuccess:()=>{h({title:"Shift template created successfully"}),x.invalidateQueries({queryKey:["/api/shift-templates"]}),a(!1),o()},onError:c=>{h({title:"Failed to create template",description:c.message,variant:"destructive"})}}),f=W({mutationFn:async c=>(await D("DELETE",`/api/shift-templates/${c}`)).json(),onSuccess:()=>{h({title:"Template deleted successfully"}),x.invalidateQueries({queryKey:["/api/shift-templates"]})},onError:c=>{h({title:"Failed to delete template",description:c.message,variant:"destructive"})}}),o=()=>{n({name:"",duration:"",hourlyRate:"",requirements:"",description:""})},u=async c=>{h({title:"Template applied",description:`Shift creation form filled with ${c.name} template`})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Shift Templates"}),e.jsx("p",{className:"text-muted-foreground",children:"Create reusable templates for common shift types"})]}),e.jsxs(se,{open:t,onOpenChange:a,children:[e.jsx(ze,{asChild:!0,children:e.jsxs(g,{"data-testid":"button-create-shift-template",children:[e.jsx(X,{className:"w-4 h-4 mr-2"}),"Create Template"]})}),e.jsxs(ae,{children:[e.jsx(ie,{children:e.jsx(ne,{children:"Create Shift Template"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(E,{placeholder:"Template name (e.g., 'Morning Security')",value:s.name,onChange:c=>n({...s,name:c.target.value}),"data-testid":"input-template-name"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-1 block",children:"Duration (hours)"}),e.jsx(E,{type:"number",placeholder:"8",value:s.duration,onChange:c=>n({...s,duration:c.target.value}),"data-testid":"input-template-duration"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-1 block",children:"Hourly Rate"}),e.jsx(E,{type:"number",placeholder:"25.00",value:s.hourlyRate,onChange:c=>n({...s,hourlyRate:c.target.value}),"data-testid":"input-template-rate"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-1 block",children:"Requirements"}),e.jsx(E,{placeholder:"Security clearance, lifting certification, etc.",value:s.requirements,onChange:c=>n({...s,requirements:c.target.value}),"data-testid":"input-template-requirements"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-1 block",children:"Description"}),e.jsx(At,{placeholder:"Detailed description of the shift responsibilities...",value:s.description,onChange:c=>n({...s,description:c.target.value}),"data-testid":"textarea-template-description"})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(g,{variant:"outline",onClick:()=>a(!1),children:"Cancel"}),e.jsx(g,{onClick:()=>C.mutate(s),disabled:C.isPending||!s.name||!s.duration,"data-testid":"button-save-template",children:C.isPending?"Creating...":"Create Template"})]})]})]})]})]}),e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:b?e.jsx("div",{className:"col-span-full flex items-center justify-center py-8",children:e.jsx("div",{className:"animate-spin w-6 h-6 border-4 border-primary border-t-transparent rounded-full"})}):v.length===0?e.jsx(S,{className:"col-span-full",children:e.jsxs(k,{className:"py-8 text-center",children:[e.jsx(Ne,{className:"w-12 h-12 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No Shift Templates"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Create templates to quickly create similar shifts"}),e.jsxs(g,{onClick:()=>a(!0),children:[e.jsx(X,{className:"w-4 h-4 mr-2"}),"Create First Template"]})]})}):v.map(c=>e.jsxs(S,{className:"hover:shadow-md transition-shadow",children:[e.jsx(H,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(L,{className:"text-base",children:c.name}),e.jsx(O,{variant:c.isActive?"default":"secondary",children:c.isActive?"Active":"Inactive"})]})}),e.jsx(k,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center text-sm text-muted-foreground",children:[e.jsx(J,{className:"w-4 h-4 mr-2"}),c.duration," hours"]}),c.hourlyRate&&e.jsxs("div",{className:"font-semibold text-primary",children:["$",c.hourlyRate,"/hr"]}),c.requirements&&e.jsxs("div",{className:"text-sm",children:[e.jsx("strong",{children:"Requirements:"})," ",c.requirements]}),c.description&&e.jsx("div",{className:"text-sm text-muted-foreground",children:c.description.length>100?`${c.description.slice(0,100)}...`:c.description}),e.jsxs("div",{className:"flex justify-end space-x-2 pt-2",children:[e.jsx(g,{size:"sm",variant:"outline",onClick:()=>u(c),"data-testid":`button-use-template-${c.id}`,children:"Use Template"}),e.jsx(g,{size:"sm",variant:"outline","data-testid":`button-edit-template-${c.id}`,children:e.jsx(je,{className:"w-3 h-3"})}),e.jsx(g,{size:"sm",variant:"outline",onClick:()=>f.mutate(c.id),"data-testid":`button-delete-template-${c.id}`,children:e.jsx(we,{className:"w-3 h-3"})})]})]})})]},c.id))})]})}const Oe=["#0088FE","#00C49F","#FFBB28","#FF8042","#8884d8"];function vs(){var d,s;const{data:t,isLoading:a}=P({queryKey:["/api/scheduling/analytics"],queryFn:async()=>(await D("GET","/api/scheduling/analytics")).json()}),{data:l}=P({queryKey:["/api/scheduling/utilization"],queryFn:async()=>(await D("GET","/api/scheduling/utilization")).json()});return a?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"animate-spin w-6 h-6 border-4 border-primary border-t-transparent rounded-full"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[e.jsx(S,{children:e.jsx(k,{className:"p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(le,{className:"h-8 w-8 text-blue-600"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Total Shifts"}),e.jsx("p",{className:"text-2xl font-bold","data-testid":"metric-total-shifts",children:(t==null?void 0:t.totalShifts)||0})]})]})})}),e.jsx(S,{children:e.jsx(k,{className:"p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(Ve,{className:"h-8 w-8 text-green-600"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Active Workers"}),e.jsx("p",{className:"text-2xl font-bold","data-testid":"metric-active-workers",children:(t==null?void 0:t.activeWorkers)||0})]})]})})}),e.jsx(S,{children:e.jsx(k,{className:"p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(J,{className:"h-8 w-8 text-orange-600"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Avg Fill Rate"}),e.jsxs("p",{className:"text-2xl font-bold","data-testid":"metric-fill-rate",children:[(t==null?void 0:t.fillRate)||0,"%"]})]})]})})}),e.jsx(S,{children:e.jsx(k,{className:"p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(It,{className:"h-8 w-8 text-purple-600"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Weekly Cost"}),e.jsxs("p",{className:"text-2xl font-bold","data-testid":"metric-weekly-cost",children:["$",(t==null?void 0:t.weeklyCost)||0]})]})]})})})]}),e.jsxs("div",{className:"grid gap-6 lg:grid-cols-2",children:[e.jsxs(S,{children:[e.jsx(H,{children:e.jsxs(L,{className:"flex items-center",children:[e.jsx(Ye,{className:"w-5 h-5 mr-2"}),"Shift Status Distribution"]})}),e.jsx(k,{children:e.jsx(Ee,{width:"100%",height:250,children:e.jsxs(Lt,{children:[e.jsx(Kt,{data:(t==null?void 0:t.shiftStatusDistribution)||[],cx:"50%",cy:"50%",labelLine:!1,label:({name:n,value:h})=>`${n}: ${h}`,outerRadius:80,fill:"#8884d8",dataKey:"value",children:((t==null?void 0:t.shiftStatusDistribution)||[]).map((n,h)=>e.jsx($t,{fill:Oe[h%Oe.length]},`cell-${h}`))}),e.jsx(Me,{})]})})})]}),e.jsxs(S,{children:[e.jsx(H,{children:e.jsxs(L,{className:"flex items-center",children:[e.jsx(Be,{className:"w-5 h-5 mr-2"}),"Weekly Trends"]})}),e.jsx(k,{children:e.jsx(Ee,{width:"100%",height:250,children:e.jsxs(zt,{data:(t==null?void 0:t.weeklyTrends)||[],children:[e.jsx(Ft,{strokeDasharray:"3 3"}),e.jsx(Ot,{dataKey:"week"}),e.jsx(Pt,{}),e.jsx(Me,{}),e.jsx(Ht,{}),e.jsx(ge,{type:"monotone",dataKey:"shiftsCreated",stroke:"#8884d8",name:"Shifts Created"}),e.jsx(ge,{type:"monotone",dataKey:"shiftsAssigned",stroke:"#82ca9d",name:"Shifts Assigned"}),e.jsx(ge,{type:"monotone",dataKey:"shiftsCompleted",stroke:"#ffc658",name:"Shifts Completed"})]})})})]})]}),e.jsxs(S,{children:[e.jsx(H,{children:e.jsxs(L,{className:"flex items-center",children:[e.jsx(Ut,{className:"w-5 h-5 mr-2"}),"Worker Utilization"]})}),e.jsx(k,{children:e.jsx("div",{className:"space-y-4",children:(d=l==null?void 0:l.workers)==null?void 0:d.map(n=>{var h,x;return e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("div",{className:"w-8 h-8 bg-primary rounded-full flex items-center justify-center text-primary-foreground text-sm font-semibold",children:[(h=n.firstName)==null?void 0:h[0],(x=n.lastName)==null?void 0:x[0]]}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-medium",children:[n.firstName," ",n.lastName]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[n.hoursThisWeek,"h this week â€¢ ",n.shiftsCompleted," shifts completed"]})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-32",children:e.jsx(te,{value:n.utilizationPercent,className:"h-2"})}),e.jsxs("div",{className:"text-sm font-medium w-12 text-right",children:[n.utilizationPercent,"%"]}),n.isOverloaded&&e.jsx(O,{variant:"destructive",className:"text-xs",children:"Overloaded"})]})]},n.id)})})})]}),((s=t==null?void 0:t.complianceAlerts)==null?void 0:s.length)>0&&e.jsxs(S,{children:[e.jsx(H,{children:e.jsxs(L,{className:"flex items-center text-destructive",children:[e.jsx(Z,{className:"w-5 h-5 mr-2"}),"Compliance Alerts"]})}),e.jsx(k,{children:e.jsx("div",{className:"space-y-3",children:t.complianceAlerts.map((n,h)=>e.jsxs("div",{className:"p-3 border-l-4 border-destructive bg-destructive/5 rounded",children:[e.jsx("div",{className:"font-medium",children:n.title}),e.jsx("div",{className:"text-sm text-muted-foreground",children:n.description}),e.jsxs("div",{className:"text-xs text-destructive mt-1",children:["Severity: ",n.severity," | Deadline: ",n.deadline]})]},h))})})]})]})}const oe=[{id:"google-calendar",name:"Google Calendar",description:"Sync schedules with Google Calendar for seamless time management",icon:qe,category:"Calendar",features:["Two-way sync","Event reminders","Recurring events"]},{id:"outlook-calendar",name:"Outlook Calendar",description:"Microsoft Outlook calendar integration for enterprise environments",icon:qe,category:"Calendar",features:["Exchange sync","Meeting requests","Availability tracking"]},{id:"zoom",name:"Zoom",description:"Create and manage Zoom meetings directly from schedule events",icon:J,category:"Communication",features:["Auto meeting links","Recording integration","Participant tracking"]},{id:"microsoft-teams",name:"Microsoft Teams",description:"Integrate with Teams for seamless communication and meetings",icon:Ae,category:"Communication",features:["Team channels","Meeting scheduling","Chat integration"]},{id:"sms-notifications",name:"SMS Notifications",description:"Send SMS reminders and updates for schedule changes",icon:yt,category:"Notifications",features:["Shift reminders","Schedule changes","Emergency alerts"]},{id:"email-notifications",name:"Email Notifications",description:"Automated email notifications for scheduling events",icon:bt,category:"Notifications",features:["Daily digests","Schedule confirmations","Reminder emails"]},{id:"slack",name:"Slack",description:"Connect with Slack for team communication and updates",icon:Ae,category:"Communication",features:["Channel notifications","Direct messages","Schedule bot"]}];function Ns(){const[t,a]=y.useState(null),[l,d]=y.useState(null),{toast:s}=B(),n=re(),{data:h=[],isLoading:x}=P({queryKey:["/api/integrations/scheduling"],queryFn:async()=>(await D("GET","/api/integrations/scheduling")).json()}),v=W({mutationFn:async({serviceId:o,enabled:u})=>(await D("POST",`/api/integrations/${o}/toggle`,{enabled:u})).json(),onSuccess:(o,u)=>{var c;s({title:`${u.enabled?"Enabled":"Disabled"} integration`,description:`${(c=oe.find(m=>m.id===u.serviceId))==null?void 0:c.name} integration updated`}),n.invalidateQueries({queryKey:["/api/integrations/scheduling"]})},onError:o=>{s({title:"Integration update failed",description:o.message,variant:"destructive"})}}),b=W({mutationFn:async o=>(await D("POST",`/api/integrations/${o}/test`)).json(),onSuccess:(o,u)=>{var c;s({title:"Connection successful",description:`${(c=oe.find(m=>m.id===u))==null?void 0:c.name} is working correctly`})},onError:(o,u)=>{var c;s({title:"Connection failed",description:`Unable to connect to ${(c=oe.find(m=>m.id===u))==null?void 0:c.name}`,variant:"destructive"})}}),C=o=>h.find(u=>u.serviceId===o)||{serviceId:o,enabled:!1,configured:!1,lastSync:null,status:"disconnected"},f=o=>{d(o),b.mutate(o),setTimeout(()=>d(null),2e3)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Calendar & Communication Integrations"}),e.jsx("p",{className:"text-muted-foreground",children:"Connect with external services to automate scheduling workflows"})]}),e.jsx(g,{variant:"outline","data-testid":"button-sync-all-integrations",children:"Sync All"})]}),e.jsx("div",{className:"grid gap-6",children:oe.map(o=>{const u=o.icon,c=C(o.id);return e.jsx(S,{children:e.jsxs(k,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-12 h-12 bg-primary/10 rounded-lg flex items-center justify-center",children:e.jsx(u,{className:"w-6 h-6 text-primary"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-1",children:[e.jsx("h4",{className:"font-semibold",children:o.name}),e.jsx(O,{variant:c.enabled?"default":"secondary",children:c.enabled?"Connected":"Disconnected"}),e.jsx(O,{variant:"outline",children:o.category})]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:o.description}),e.jsx("div",{className:"flex flex-wrap gap-1",children:o.features.map((m,r)=>e.jsx(O,{variant:"outline",className:"text-xs",children:m},r))})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(g,{variant:"outline",size:"sm",onClick:()=>f(o.id),disabled:!c.configured||l===o.id,"data-testid":`button-test-${o.id}`,children:l===o.id?"Testing...":"Test"}),e.jsx(Ke,{checked:c.enabled,onCheckedChange:m=>v.mutate({serviceId:o.id,enabled:m}),disabled:!c.configured,"data-testid":`switch-${o.id}`})]})]}),c.enabled&&c.status==="error"&&e.jsx("div",{className:"mt-4 p-3 bg-destructive/10 border border-destructive/20 rounded-md",children:e.jsxs("div",{className:"flex items-center text-sm text-destructive",children:[e.jsx(wt,{className:"w-4 h-4 mr-2"}),"Connection error: Unable to sync with ",o.name]})})]})},o.id)})})]})}function ys(){const{toast:t}=B(),{data:a,isLoading:l}=P({queryKey:["/api/compliance/overview"],queryFn:async()=>(await D("GET","/api/compliance/overview")).json()}),d=W({mutationFn:async()=>(await D("POST","/api/compliance/check")).json(),onSuccess:n=>{t({title:"Compliance check completed",description:`Found ${n.violations} violations and ${n.warnings} warnings`})},onError:n=>{t({title:"Compliance check failed",description:n.message,variant:"destructive"})}});if(l)return e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"animate-spin w-6 h-6 border-4 border-primary border-t-transparent rounded-full"})});const s={overallScore:94,criticalViolations:0,laborLawCompliance:98,overtimeCompliance:92,breakCompliance:96,maxHoursCompliance:100,violations:[{id:"1",severity:"warning",title:"Overtime Threshold Approaching",description:"Worker John Doe has 38 hours scheduled this week",recommendation:"Consider redistributing shifts to avoid overtime",dueDate:"2025-09-02"},{id:"2",severity:"warning",title:"Break Schedule Gap",description:"Shift on Sept 1st lacks mandatory break scheduling",recommendation:"Add 30-minute break to 8-hour shift",dueDate:"2025-09-01"}],weeklyReport:{totalHours:1240,overtimeHours:45,complianceRate:94,breakViolations:2}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Compliance & Labor Law Tracking"}),e.jsx("p",{className:"text-muted-foreground",children:"Monitor compliance with labor regulations and company policies"})]}),e.jsx(g,{onClick:()=>d.mutate(),disabled:d.isPending,"data-testid":"button-run-compliance-check",children:d.isPending?"Checking...":"Run Compliance Check"})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[e.jsx(S,{children:e.jsx(k,{className:"p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(Ct,{className:"h-8 w-8 text-green-600"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Overall Score"}),e.jsxs("p",{className:"text-2xl font-bold text-green-600","data-testid":"metric-overall-score",children:[s.overallScore,"%"]})]})]})})}),e.jsx(S,{children:e.jsx(k,{className:"p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(Z,{className:"h-8 w-8 text-red-600"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Critical Issues"}),e.jsx("p",{className:"text-2xl font-bold","data-testid":"metric-critical-violations",children:s.criticalViolations})]})]})})}),e.jsx(S,{children:e.jsx(k,{className:"p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(J,{className:"h-8 w-8 text-orange-600"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Overtime Hours"}),e.jsx("p",{className:"text-2xl font-bold","data-testid":"metric-overtime-hours",children:s.weeklyReport.overtimeHours})]})]})})}),e.jsx(S,{children:e.jsx(k,{className:"p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(Ve,{className:"h-8 w-8 text-blue-600"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Break Violations"}),e.jsx("p",{className:"text-2xl font-bold","data-testid":"metric-break-violations",children:s.weeklyReport.breakViolations})]})]})})})]}),e.jsxs("div",{className:"grid gap-6 lg:grid-cols-2",children:[e.jsxs(S,{children:[e.jsx(H,{children:e.jsxs(L,{className:"flex items-center",children:[e.jsx(Ye,{className:"w-5 h-5 mr-2"}),"Compliance Areas"]})}),e.jsx(k,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-medium",children:"Labor Law Compliance"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(te,{value:s.laborLawCompliance,className:"w-24"}),e.jsxs("span",{className:"text-sm font-medium",children:[s.laborLawCompliance,"%"]})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-medium",children:"Overtime Management"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(te,{value:s.overtimeCompliance,className:"w-24"}),e.jsxs("span",{className:"text-sm font-medium",children:[s.overtimeCompliance,"%"]})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-medium",children:"Break Scheduling"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(te,{value:s.breakCompliance,className:"w-24"}),e.jsxs("span",{className:"text-sm font-medium",children:[s.breakCompliance,"%"]})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-medium",children:"Maximum Hours"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(te,{value:s.maxHoursCompliance,className:"w-24"}),e.jsxs("span",{className:"text-sm font-medium",children:[s.maxHoursCompliance,"%"]})]})]})]})})]}),e.jsxs(S,{children:[e.jsx(H,{children:e.jsxs(L,{className:"flex items-center",children:[e.jsx(Be,{className:"w-5 h-5 mr-2"}),"Weekly Summary"]})}),e.jsx(k,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-center",children:[e.jsxs("div",{className:"p-3 bg-muted rounded",children:[e.jsx("div",{className:"text-2xl font-bold",children:s.weeklyReport.totalHours}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Total Hours"})]}),e.jsxs("div",{className:"p-3 bg-muted rounded",children:[e.jsx("div",{className:"text-2xl font-bold text-orange-600",children:s.weeklyReport.overtimeHours}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Overtime Hours"})]})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-3xl font-bold text-green-600",children:[s.weeklyReport.complianceRate,"%"]}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Compliance Rate"})]})]})})]})]}),s.violations.length>0&&e.jsxs(S,{children:[e.jsx(H,{children:e.jsxs(L,{className:"flex items-center",children:[e.jsx(Z,{className:"w-5 h-5 mr-2 text-orange-600"}),"Active Compliance Issues"]})}),e.jsx(k,{children:e.jsx("div",{className:"space-y-3",children:s.violations.map(n=>e.jsxs(Tt,{className:"border-l-4 border-orange-500",children:[e.jsx(Z,{className:"h-4 w-4"}),e.jsx(St,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"font-medium",children:n.title}),e.jsx(O,{variant:n.severity==="critical"?"destructive":"secondary",children:n.severity})]}),e.jsx("p",{className:"text-sm",children:n.description}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[e.jsx("strong",{children:"Recommendation:"})," ",n.recommendation]}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[e.jsx("strong",{children:"Due:"})," ",n.dueDate]})]})})]},n.id))})})]}),e.jsxs(S,{children:[e.jsx(H,{children:e.jsxs(L,{className:"flex items-center",children:[e.jsx(Ne,{className:"w-5 h-5 mr-2"}),"Compliance Actions"]})}),e.jsx(k,{children:e.jsxs("div",{className:"grid gap-3 md:grid-cols-3",children:[e.jsx(g,{variant:"outline",className:"h-auto p-4","data-testid":"button-export-compliance-report",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Ne,{className:"w-6 h-6 mx-auto mb-2"}),e.jsx("div",{className:"font-medium",children:"Export Report"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Generate compliance PDF"})]})}),e.jsx(g,{variant:"outline",className:"h-auto p-4","data-testid":"button-schedule-audit",children:e.jsxs("div",{className:"text-center",children:[e.jsx(le,{className:"w-6 h-6 mx-auto mb-2"}),e.jsx("div",{className:"font-medium",children:"Schedule Audit"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Review upcoming shifts"})]})}),e.jsx(g,{variant:"outline",className:"h-auto p-4","data-testid":"button-policy-settings",children:e.jsxs("div",{className:"text-center",children:[e.jsx(kt,{className:"w-6 h-6 mx-auto mb-2"}),e.jsx("div",{className:"font-medium",children:"Policy Settings"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Configure compliance rules"})]})})]})})]})]})}function la(){const{toast:t}=B(),{isAuthenticated:a,isLoading:l}=Dt();return y.useEffect(()=>{if(!l&&!a){t({title:"Unauthorized",description:"You are logged out. Logging in again...",variant:"destructive"}),setTimeout(()=>{window.location.href="/api/login"},500);return}},[a,l,t]),l||!a?e.jsx("div",{className:"h-screen flex items-center justify-center",children:e.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-primary border-t-transparent rounded-full"})}):e.jsx(Mt,{title:"Schedule",breadcrumbs:[{label:"Management",href:"/dashboard"},{label:"Schedule"}],children:e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-semibold text-foreground",children:"Advanced Schedule Management"}),e.jsx("p",{className:"text-muted-foreground",children:"Comprehensive workforce scheduling with analytics and automation"})]})}),e.jsxs(Rt,{defaultValue:"calendar",className:"space-y-6",children:[e.jsxs(Et,{className:"grid w-full grid-cols-7",children:[e.jsx(V,{value:"calendar","data-testid":"tab-calendar",children:"Calendar"}),e.jsx(V,{value:"recurring","data-testid":"tab-recurring",children:"Recurring"}),e.jsx(V,{value:"templates","data-testid":"tab-templates",children:"Templates"}),e.jsx(V,{value:"availability","data-testid":"tab-availability",children:"Availability"}),e.jsx(V,{value:"analytics","data-testid":"tab-analytics",children:"Analytics"}),e.jsx(V,{value:"integrations","data-testid":"tab-integrations",children:"Integrations"}),e.jsx(V,{value:"compliance","data-testid":"tab-compliance",children:"Compliance"})]}),e.jsxs(Y,{value:"calendar",className:"space-y-6",children:[e.jsx("div",{className:"hidden md:block",children:e.jsx(cs,{})}),e.jsx(os,{shifts:[],onCreateShift:()=>{},onEditShift:()=>{},onDeleteShift:()=>{},isLoading:!1})]}),e.jsx(Y,{value:"recurring",children:e.jsx(js,{})}),e.jsx(Y,{value:"templates",children:e.jsx(gs,{})}),e.jsx(Y,{value:"availability",children:e.jsx(fs,{})}),e.jsx(Y,{value:"analytics",children:e.jsx(vs,{})}),e.jsx(Y,{value:"integrations",children:e.jsx(Ns,{})}),e.jsx(Y,{value:"compliance",children:e.jsx(ys,{})})]})]})})}export{la as default};
